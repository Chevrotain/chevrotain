/*! chevrotain - v0.11.3 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("chevrotain",[],e):"object"==typeof exports?exports.chevrotain=e():t.chevrotain=e()}(this,function(){return function(t){function __webpack_require__(n){if(e[n])return e[n].exports;var r=e[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,__webpack_require__),r.loaded=!0,r.exports}var e={};return __webpack_require__.m=t,__webpack_require__.c=e,__webpack_require__.p="",__webpack_require__(0)}([function(t,e,n){"use strict";var r=n(1),o=n(11),i=n(10),a=n(5),s=n(7),c=n(21),u=n(15),l={};l.VERSION="0.11.3",l.Parser=r.Parser,l.ParserDefinitionErrorType=r.ParserDefinitionErrorType,l.Lexer=o.Lexer,l.LexerDefinitionErrorType=o.LexerDefinitionErrorType,l.Token=i.Token,l.VirtualToken=i.VirtualToken,l.EOF=i.EOF,l.extendToken=i.extendToken,l.tokenName=i.tokenName,l.tokenLabel=i.tokenLabel,l.EMPTY_ALT=r.EMPTY_ALT,l.exceptions={},l.exceptions.isRecognitionException=a.exceptions.isRecognitionException,l.exceptions.EarlyExitException=a.exceptions.EarlyExitException,l.exceptions.MismatchedTokenException=a.exceptions.MismatchedTokenException,l.exceptions.NotAllInputParsedException=a.exceptions.NotAllInputParsedException,l.exceptions.NoViableAltException=a.exceptions.NoViableAltException,l.gast={},l.gast.GAstVisitor=s.gast.GAstVisitor,l.gast.Flat=s.gast.Flat,l.gast.Repetition=s.gast.Repetition,l.gast.RepetitionWithSeparator=s.gast.RepetitionWithSeparator,l.gast.RepetitionMandatory=s.gast.RepetitionMandatory,l.gast.RepetitionMandatoryWithSeparator=s.gast.RepetitionMandatoryWithSeparator,l.gast.Option=s.gast.Option,l.gast.Alternation=s.gast.Alternation,l.gast.NonTerminal=s.gast.NonTerminal,l.gast.Terminal=s.gast.Terminal,l.gast.Rule=s.gast.Rule,l.interperter={},l.interperter.NextAfterTokenWalker=u.NextAfterTokenWalker,l.clearCache=c.clearCache,t.exports=l},function(t,e,n){"use strict";function EMPTY_ALT(t){return void 0===t&&(t=void 0),function(){return t}}function InRuleRecoveryException(t){this.name=i.functionName(InRuleRecoveryException),this.message=t}var r=n(2),o=n(5),i=n(3),a=n(6),s=n(8),c=n(4),u=n(17),l=n(10),p=n(14),f=n(19),h=n(15),d=n(18),E=n(9);!function(t){t[t.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",t[t.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",t[t.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",t[t.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",t[t.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",t[t.LEFT_RECURSION=5]="LEFT_RECURSION",t[t.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",t[t.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS"}(e.ParserDefinitionErrorType||(e.ParserDefinitionErrorType={}));var T=(e.ParserDefinitionErrorType,Object.freeze({recoveryEnabled:!1,maxLookahead:5,ignoredIssues:{}})),A=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0});e.EMPTY_ALT=EMPTY_ALT;var _={},y=function(){function Parser(t,e,n){if(void 0===n&&(n=T),this.errors=[],this._input=[],this.inputIdx=-1,this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.tokensMap=void 0,this.definedRulesNames=[],this._productions=new i.HashTable,this._input=t,this.recoveryEnabled=c.has(n,"recoveryEnabled")?n.recoveryEnabled:T.recoveryEnabled,this.maxLookahead=c.has(n,"maxLookahead")?n.maxLookahead:T.maxLookahead,this.ignoredIssues=c.has(n,"ignoredIssues")?n.ignoredIssues:T.ignoredIssues,this.className=i.classNameFromInstance(this),this.firstAfterRepMap=r.getFirstAfterRepForClass(this.className),this.classLAFuncs=r.getLookaheadFuncsForClass(this.className),r.CLASS_TO_DEFINITION_ERRORS.containsKey(this.className)?this.definitionErrors=r.CLASS_TO_DEFINITION_ERRORS.get(this.className):(this.definitionErrors=[],r.CLASS_TO_DEFINITION_ERRORS.put(this.className,this.definitionErrors)),c.isArray(e))this.tokensMap=c.reduce(e,function(t,e){return t[l.tokenName(e)]=e,t},{});else{if(!c.isObject(e))throw new Error("'tokensMapOrArr' argument must be An Array of Token constructors or a Dictionary of Tokens.");this.tokensMap=c.cloneObj(e)}this.tokensMap[l.tokenName(l.EOF)]=l.EOF,void 0===r.CLASS_TO_OR_LA_CACHE[this.className]&&r.initLookAheadKeyCache(this.className),this.orLookaheadKeys=r.CLASS_TO_OR_LA_CACHE[this.className],this.manyLookaheadKeys=r.CLASS_TO_MANY_LA_CACHE[this.className],this.manySepLookaheadKeys=r.CLASS_TO_MANY_SEP_LA_CACHE[this.className],this.atLeastOneLookaheadKeys=r.CLASS_TO_AT_LEAST_ONE_LA_CACHE[this.className],this.atLeastOneSepLookaheadKeys=r.CLASS_TO_AT_LEAST_ONE_SEP_LA_CACHE[this.className],this.optionLookaheadKeys=r.CLASS_TO_OPTION_LA_CACHE[this.className]}return Parser.performSelfAnalysis=function(t){var e,n=[],o=i.classNameFromInstance(t);if(""===o)throw Error("A Parser's constructor may not be an anonymous Function, it must be a named function\nThe constructor's name is used at runtime for performance (caching) purposes.");if(!r.CLASS_TO_SELF_ANALYSIS_DONE.containsKey(o)){r.CLASS_TO_SELF_ANALYSIS_DONE.put(o,!0);var l=t._productions,p=new i.HashTable;c.forEach(l.keys(),function(t){var e=l.get(t);p.put(t,E.cloneProduction(e))}),r.getProductionsForClass(o).putAll(p),n=r.CLASS_TO_DEFINITION_ERRORS.get(o);var f=a.resolveGrammar(p);if(n.push.apply(n,f),c.isEmpty(f)){var h=s.validateGrammar(p.values(),t.maxLookahead,t.ignoredIssues);n.push.apply(n,h)}if(!c.isEmpty(n)&&!Parser.DEFER_DEFINITION_ERRORS_HANDLING)throw e=c.map(n,function(t){return t.message}),new Error("Parser Definition Errors detected\n: "+e.join("\n-------------------------------\n"));if(c.isEmpty(n)){var d=u.computeAllProdsFollows(p.values());r.setResyncFollowsForClass(o,d)}}if(!c.isEmpty(r.CLASS_TO_DEFINITION_ERRORS.get(o))&&!Parser.DEFER_DEFINITION_ERRORS_HANDLING)throw e=c.map(r.CLASS_TO_DEFINITION_ERRORS.get(o),function(t){return t.message}),new Error("Parser Definition Errors detected\n: "+e.join("\n-------------------------------\n"))},Object.defineProperty(Parser.prototype,"input",{get:function(){return c.cloneArr(this._input)},set:function(t){this.reset(),this._input=t},enumerable:!0,configurable:!0}),Parser.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this._input=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[]},Parser.prototype.isAtEndOfInput=function(){return this.LA(1)instanceof l.EOF},Parser.prototype.getGAstProductions=function(){return r.getProductionsForClass(this.className)},Parser.prototype.isBackTracking=function(){return!c.isEmpty(this.isBackTrackingStack)},Parser.prototype.SAVE_ERROR=function(t){if(o.exceptions.isRecognitionException(t))return t.context={ruleStack:c.cloneArr(this.RULE_STACK),ruleOccurrenceStack:c.cloneArr(this.RULE_OCCURRENCE_STACK)},this.errors.push(t),t;throw Error("Trying to save an Error which is not a RecognitionException")},Parser.prototype.BACKTRACK=function(t,e){return function(){this.isBackTrackingStack.push(1);var n=this.saveRecogState();try{var r=t.call(this);return e(r)}catch(i){if(o.exceptions.isRecognitionException(i))return!1;throw i}finally{this.reloadRecogState(n),this.isBackTrackingStack.pop()}}},Parser.prototype.SKIP_TOKEN=function(){return this.inputIdx<=this._input.length-2?(this.consumeToken(),this.LA(1)):new l.EOF},Parser.prototype.CONSUME=function(t){return this.CONSUME1(t)},Parser.prototype.CONSUME1=function(t){return this.consumeInternal(t,1)},Parser.prototype.CONSUME2=function(t){return this.consumeInternal(t,2)},Parser.prototype.CONSUME3=function(t){return this.consumeInternal(t,3)},Parser.prototype.CONSUME4=function(t){return this.consumeInternal(t,4)},Parser.prototype.CONSUME5=function(t){return this.consumeInternal(t,5)},Parser.prototype.SUBRULE=function(t,e){return void 0===e&&(e=[]),this.SUBRULE1(t,e)},Parser.prototype.SUBRULE1=function(t,e){return void 0===e&&(e=[]),t.call(this,1,e)},Parser.prototype.SUBRULE2=function(t,e){return void 0===e&&(e=[]),t.call(this,2,e)},Parser.prototype.SUBRULE3=function(t,e){return void 0===e&&(e=[]),t.call(this,3,e)},Parser.prototype.SUBRULE4=function(t,e){return void 0===e&&(e=[]),t.call(this,4,e)},Parser.prototype.SUBRULE5=function(t,e){return void 0===e&&(e=[]),t.call(this,5,e)},Parser.prototype.OPTION=function(t,e){return this.OPTION1.call(this,t,e)},Parser.prototype.OPTION1=function(t,e){return this.optionInternal(t,e,1)},Parser.prototype.OPTION2=function(t,e){return this.optionInternal(t,e,2)},Parser.prototype.OPTION3=function(t,e){return this.optionInternal(t,e,3)},Parser.prototype.OPTION4=function(t,e){return this.optionInternal(t,e,4)},Parser.prototype.OPTION5=function(t,e){return this.optionInternal(t,e,5)},Parser.prototype.OR=function(t,e){return this.OR1(t,e)},Parser.prototype.OR1=function(t,e){return this.orInternal(t,e,1)},Parser.prototype.OR2=function(t,e){return this.orInternal(t,e,2)},Parser.prototype.OR3=function(t,e){return this.orInternal(t,e,3)},Parser.prototype.OR4=function(t,e){return this.orInternal(t,e,4)},Parser.prototype.OR5=function(t,e){return this.orInternal(t,e,5)},Parser.prototype.MANY=function(t,e){return this.MANY1.call(this,t,e)},Parser.prototype.MANY1=function(t,e){this.manyInternal(this.MANY1,"MANY1",1,t,e)},Parser.prototype.MANY2=function(t,e){this.manyInternal(this.MANY2,"MANY2",2,t,e)},Parser.prototype.MANY3=function(t,e){this.manyInternal(this.MANY3,"MANY3",3,t,e)},Parser.prototype.MANY4=function(t,e){this.manyInternal(this.MANY4,"MANY4",4,t,e)},Parser.prototype.MANY5=function(t,e){this.manyInternal(this.MANY5,"MANY5",5,t,e)},Parser.prototype.MANY_SEP=function(t,e){return this.MANY_SEP1.call(this,t,e)},Parser.prototype.MANY_SEP1=function(t,e){return this.manySepFirstInternal(this.MANY_SEP1,"MANY_SEP1",1,t,e)},Parser.prototype.MANY_SEP2=function(t,e){return this.manySepFirstInternal(this.MANY_SEP2,"MANY_SEP2",2,t,e)},Parser.prototype.MANY_SEP3=function(t,e){return this.manySepFirstInternal(this.MANY_SEP3,"MANY_SEP3",3,t,e)},Parser.prototype.MANY_SEP4=function(t,e){return this.manySepFirstInternal(this.MANY_SEP4,"MANY_SEP4",4,t,e)},Parser.prototype.MANY_SEP5=function(t,e){return this.manySepFirstInternal(this.MANY_SEP5,"MANY_SEP5",5,t,e)},Parser.prototype.AT_LEAST_ONE=function(t,e,n){return this.AT_LEAST_ONE1.call(this,t,e,n)},Parser.prototype.AT_LEAST_ONE1=function(t,e,n){this.atLeastOneInternal(this.AT_LEAST_ONE1,"AT_LEAST_ONE1",1,t,e,n)},Parser.prototype.AT_LEAST_ONE2=function(t,e,n){this.atLeastOneInternal(this.AT_LEAST_ONE2,"AT_LEAST_ONE2",2,t,e,n)},Parser.prototype.AT_LEAST_ONE3=function(t,e,n){this.atLeastOneInternal(this.AT_LEAST_ONE3,"AT_LEAST_ONE3",3,t,e,n)},Parser.prototype.AT_LEAST_ONE4=function(t,e,n){this.atLeastOneInternal(this.AT_LEAST_ONE4,"AT_LEAST_ONE4",4,t,e,n)},Parser.prototype.AT_LEAST_ONE5=function(t,e,n){this.atLeastOneInternal(this.AT_LEAST_ONE5,"AT_LEAST_ONE5",5,t,e,n)},Parser.prototype.AT_LEAST_ONE_SEP=function(t,e,n){return this.AT_LEAST_ONE_SEP1.call(this,t,e,n)},Parser.prototype.AT_LEAST_ONE_SEP1=function(t,e,n){return this.atLeastOneSepFirstInternal(this.atLeastOneSepFirstInternal,"AT_LEAST_ONE_SEP1",1,t,e,n)},Parser.prototype.AT_LEAST_ONE_SEP2=function(t,e,n){return this.atLeastOneSepFirstInternal(this.atLeastOneSepFirstInternal,"AT_LEAST_ONE_SEP2",2,t,e,n)},Parser.prototype.AT_LEAST_ONE_SEP3=function(t,e,n){return this.atLeastOneSepFirstInternal(this.atLeastOneSepFirstInternal,"AT_LEAST_ONE_SEP3",3,t,e,n)},Parser.prototype.AT_LEAST_ONE_SEP4=function(t,e,n){return this.atLeastOneSepFirstInternal(this.atLeastOneSepFirstInternal,"AT_LEAST_ONE_SEP4",4,t,e,n)},Parser.prototype.AT_LEAST_ONE_SEP5=function(t,e,n){return this.atLeastOneSepFirstInternal(this.atLeastOneSepFirstInternal,"AT_LEAST_ONE_SEP5",5,t,e,n)},Parser.prototype.RULE=function(t,e,n){void 0===n&&(n=A);var o=s.validateRuleName(t,this.className);if(o=o.concat(s.validateRuleDoesNotAlreadyExist(t,this.definedRulesNames,this.className)),this.definedRulesNames.push(t),this.definitionErrors.push.apply(this.definitionErrors,o),this._productions.containsKey(t)){var i=r.getProductionsForClass(this.className),a=i.get(t);c.isUndefined(a)||this._productions.put(t,a)}else{var u=f.buildTopProduction(e.toString(),t,this.tokensMap);this._productions.put(t,u)}return this.defineRule(t,e,n)},Parser.prototype.OVERRIDE_RULE=function(t,e,n){void 0===n&&(n=A);var o=s.validateRuleName(t,this.className);o=o.concat(s.validateRuleIsOverridden(t,this.definedRulesNames,this.className)),this.definitionErrors.push.apply(this.definitionErrors,o);var i=r.getProductionOverriddenForClass(this.className);if(i.containsKey(t)){var a=r.getProductionsForClass(this.className);this._productions.put(t,a.get(t))}else{i.put(t,!0);var c=f.buildTopProduction(e.toString(),t,this.tokensMap);this._productions.put(t,c)}return this.defineRule(t,e,n)},Parser.prototype.ruleInvocationStateUpdate=function(t,e){this.RULE_OCCURRENCE_STACK.push(e),this.RULE_STACK.push(t)},Parser.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),0===this.RULE_STACK.length&&this.hasAllInputBeenConsumed()){var t=this.LA(1);this.SAVE_ERROR(new o.exceptions.NotAllInputParsedException("Redundant input, expecting EOF but found: "+t.image,t))}},Parser.prototype.getTokenToInsert=function(t){return new t(-1,-1)},Parser.prototype.canTokenTypeBeInsertedInRecovery=function(t){return!0},Parser.prototype.getMisMatchTokenErrorMessage=function(t,e){var n=l.hasTokenLabel(t),r=n?"--> "+l.tokenLabel(t)+" <--":"token of type --> "+l.tokenName(t)+" <--",o="Expecting "+r+" but found --> '"+e.image+"' <--";return o},Parser.prototype.getCurrentGrammarPath=function(t,e){var n=c.cloneArr(this.RULE_STACK),r=c.cloneArr(this.RULE_OCCURRENCE_STACK),o={ruleStack:n,occurrenceStack:r,lastTok:t,lastTokOccurrence:e};return o},Parser.prototype.getNextPossibleTokenTypes=function(t){var e=c.first(t.ruleStack),n=this.getGAstProductions(),r=n.get(e),o=new h.NextAfterTokenWalker(r,t).startWalking();return o},Parser.prototype.consumeInternal=function(t,e){try{return this.consumeInternalOptimized(t)}catch(n){if(!(this.recoveryEnabled&&n instanceof o.exceptions.MismatchedTokenException)||this.isBackTracking())throw n;var r=this.getFollowsForInRuleRecovery(t,e);try{return this.tryInRuleRecovery(t,r)}catch(a){throw a.name===i.functionName(InRuleRecoveryException)?n:a}}},Parser.prototype.NEXT_TOKEN=function(){return this.LA(1)},Parser.prototype.LA=function(t){return this._input.length<=this.inputIdx+t?new l.EOF:this._input[this.inputIdx+t]},Parser.prototype.consumeToken=function(){this.inputIdx++},Parser.prototype.saveLexerState=function(){this.savedTokenIdx=this.inputIdx},Parser.prototype.restoreLexerState=function(){this.inputIdx=this.savedTokenIdx},Parser.prototype.resetLexerState=function(){this.inputIdx=-1},Parser.prototype.saveRecogState=function(){var t=c.cloneArr(this.errors),e=c.cloneArr(this.RULE_STACK);return{errors:t,lexerState:this.inputIdx,RULE_STACK:e}},Parser.prototype.reloadRecogState=function(t){this.errors=t.errors,this.inputIdx=t.lexerState,this.RULE_STACK=t.RULE_STACK},Parser.prototype.hasAllInputBeenConsumed=function(){var t=this._input.length-1;return this.inputIdx<t},Parser.prototype.defineRule=function(t,e,n){var r=c.has(n,"resyncEnabled")?n.resyncEnabled:A.resyncEnabled,i=c.has(n,"recoveryValueFunc")?n.recoveryValueFunc:A.recoveryValueFunc,a=function(n,a){void 0===n&&(n=1),void 0===a&&(a=[]),this.ruleInvocationStateUpdate(t,n);try{return e.apply(this,a)}catch(s){var c=1===this.RULE_STACK.length,u=c||r&&!this.isBackTracking()&&this.recoveryEnabled;if(u&&o.exceptions.isRecognitionException(s)){var l=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(l))return s.resyncedTokens=this.reSyncTo(l),i();throw s}throw s}finally{this.ruleFinallyStateUpdate()}},s="ruleName";return a[s]=t,a},Parser.prototype.tryInRepetitionRecovery=function(t,e,n,r){var i=this,a=this.findReSyncTokenType();this.saveLexerState();for(var s=[],u=!1,l=this.LA(1),p=this.LA(1),f=function(){var t=i.getMisMatchTokenErrorMessage(r,l),e=new o.exceptions.MismatchedTokenException(t,l);e.resyncedTokens=c.dropRight(s),i.SAVE_ERROR(e)};!u;){if(p instanceof r)return void f();if(n.call(this))return f(),void t.apply(this,e);p instanceof a?u=!0:(p=this.SKIP_TOKEN(),this.addToResyncTokens(p,s))}this.restoreLexerState()},Parser.prototype.shouldInRepetitionRecoveryBeTried=function(t,e){return void 0===t||void 0===e?!1:this.LA(1)instanceof t?!1:this.isBackTracking()?!1:!this.canPerformInRuleRecovery(t,this.getFollowsForInRuleRecovery(t,e))},Parser.prototype.getFollowsForInRuleRecovery=function(t,e){var n=this.getCurrentGrammarPath(t,e),r=this.getNextPossibleTokenTypes(n);return r},Parser.prototype.tryInRuleRecovery=function(t,e){if(this.canRecoverWithSingleTokenInsertion(t,e)){var n=this.getTokenToInsert(t);return n.isInsertedInRecovery=!0,n}if(this.canRecoverWithSingleTokenDeletion(t)){var r=this.SKIP_TOKEN();return this.consumeToken(),r}throw new InRuleRecoveryException("sad sad panda")},Parser.prototype.canPerformInRuleRecovery=function(t,e){return this.canRecoverWithSingleTokenInsertion(t,e)||this.canRecoverWithSingleTokenDeletion(t)},Parser.prototype.canRecoverWithSingleTokenInsertion=function(t,e){if(!this.canTokenTypeBeInsertedInRecovery(t))return!1;if(c.isEmpty(e))return!1;var n=this.LA(1),r=void 0!==c.find(e,function(t){return n instanceof t});return r},Parser.prototype.canRecoverWithSingleTokenDeletion=function(t){var e=this.LA(2)instanceof t;return e},Parser.prototype.isInCurrentRuleReSyncSet=function(t){var e=this.getCurrFollowKey(),n=this.getFollowSetFromFollowKey(e);return c.contains(n,t)},Parser.prototype.findReSyncTokenType=function(){for(var t=this.flattenFollowSet(),e=this.LA(1),n=2;;){var r=e.constructor;if(c.contains(t,r))return r;e=this.LA(n),n++}},Parser.prototype.getCurrFollowKey=function(){if(1===this.RULE_STACK.length)return _;var t=this.RULE_STACK.length-1,e=t,n=t-1;return{ruleName:this.RULE_STACK[t],idxInCallingRule:this.RULE_OCCURRENCE_STACK[e],inRule:this.RULE_STACK[n]}},Parser.prototype.buildFullFollowKeyStack=function(){var t=this;return c.map(this.RULE_STACK,function(e,n){return 0===n?_:{ruleName:e,idxInCallingRule:t.RULE_OCCURRENCE_STACK[n],inRule:t.RULE_STACK[n-1]}})},Parser.prototype.flattenFollowSet=function(){var t=this,e=c.map(this.buildFullFollowKeyStack(),function(e){return t.getFollowSetFromFollowKey(e)});return c.flatten(e)},Parser.prototype.getFollowSetFromFollowKey=function(t){if(t===_)return[l.EOF];var e=t.ruleName+t.idxInCallingRule+d.IN+t.inRule;return r.getResyncFollowsForClass(this.className).get(e)},Parser.prototype.addToResyncTokens=function(t,e){return t instanceof l.EOF||e.push(t),e},Parser.prototype.reSyncTo=function(t){for(var e=[],n=this.LA(1);n instanceof t==!1;)n=this.SKIP_TOKEN(),this.addToResyncTokens(n,e);return c.dropRight(e)},Parser.prototype.attemptInRepetitionRecovery=function(t,e,n,r,o,i,a){var s=this.getKeyForAutomaticLookahead(r,a,o),u=this.firstAfterRepMap.get(s);if(void 0===u){var p=c.last(this.RULE_STACK),f=this.getGAstProductions().get(p),h=new i(f,o);u=h.startWalking(),this.firstAfterRepMap.put(s,u)}var d=u.token,E=u.occurrence,T=u.isEndOfRule;1===this.RULE_STACK.length&&T&&void 0===d&&(d=l.EOF,E=1),this.shouldInRepetitionRecoveryBeTried(d,E)&&this.tryInRepetitionRecovery(t,e,n,d)},Parser.prototype.optionInternal=function(t,e,n){return void 0===e?(e=t,t=this.getLookaheadFuncForOption(n)):t=this.getLookaheadFuncForOption(n,t),t.call(this)?(e.call(this),!0):!1},Parser.prototype.atLeastOneInternal=function(t,e,n,r,o,i){if(c.isFunction(o)?r=this.getLookaheadFuncForAtLeastOne(n,r):(i=o,o=r,r=this.getLookaheadFuncForAtLeastOne(n)),!r.call(this))throw this.raiseEarlyExitException(n,p.PROD_TYPE.REPETITION_MANDATORY,i);for(o.call(this);r.call(this);)o.call(this);this.recoveryEnabled&&this.attemptInRepetitionRecovery(t,[r,o,i],r,e,n,h.NextTerminalAfterAtLeastOneWalker,this.atLeastOneLookaheadKeys)},Parser.prototype.atLeastOneSepFirstInternal=function(t,e,n,r,o,i){var a=this,s=[],c=this.getLookaheadFuncForAtLeastOneSep(n);if(!c.call(this))throw this.raiseEarlyExitException(n,p.PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,i);o.call(this);for(var u=function(){return a.LA(1)instanceof r};u();)s.push(this.CONSUME(r)),o.call(this);return this.recoveryEnabled&&this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,n,r,u,o,s,this.atLeastOneSepLookaheadKeys,h.NextTerminalAfterAtLeastOneSepWalker],u,e,n,h.NextTerminalAfterAtLeastOneSepWalker,this.atLeastOneSepLookaheadKeys),s},Parser.prototype.manyInternal=function(t,e,n,r,o){for(void 0===o?(o=r,r=this.getLookaheadFuncForMany(n)):r=this.getLookaheadFuncForMany(n,r);r.call(this);)o.call(this);this.recoveryEnabled&&this.attemptInRepetitionRecovery(t,[r,o],r,e,n,h.NextTerminalAfterManyWalker,this.manyLookaheadKeys)},Parser.prototype.manySepFirstInternal=function(t,e,n,r,o){var i=this,a=[],s=this.getLookaheadFuncForManySep(n);if(s.call(this)){o.call(this);for(var c=function(){return i.LA(1)instanceof r};c();)a.push(this.CONSUME(r)),o.call(this);this.recoveryEnabled&&this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,n,r,c,o,a,this.manySepLookaheadKeys,h.NextTerminalAfterManySepWalker],c,e,n,h.NextTerminalAfterManySepWalker,this.manySepLookaheadKeys)}return a},Parser.prototype.repetitionSepSecondInternal=function(t,e,n,r,o,i,a,s){for(;r();)i.push(this.CONSUME(n)),o.call(this);this.recoveryEnabled&&this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,e,n,r,o,i,a,s],r,t,e,s,a)},Parser.prototype.orInternal=function(t,e,n){var r=this.getLookaheadFuncForOr(n,t),o=r.call(this);if(-1!==o){var i=t[o],a=i.ALT?i.ALT:i.THEN_DO;return a.call(this)}this.raiseNoAltException(n,e)},Parser.prototype.consumeInternalOptimized=function(t){var e=this.LA(1);if(e instanceof t)return this.consumeToken(),e;var n=this.getMisMatchTokenErrorMessage(t,e);throw this.SAVE_ERROR(new o.exceptions.MismatchedTokenException(n,e))},Parser.prototype.getKeyForAutomaticLookahead=function(t,e,n){var r=e[n-1],o=c.last(this.RULE_STACK),i=r[o];return void 0===i&&(i=t+n+d.IN+o,r[o]=i),i},Parser.prototype.getLookaheadFuncForOr=function(t,e){var n=this.getKeyForAutomaticLookahead("OR",this.orLookaheadKeys,t),r=this.classLAFuncs.get(n);if(void 0===r){var o=c.last(this.RULE_STACK),i=this.getGAstProductions().get(o),a=c.map(e,function(t){return t.WHEN});return r=p.buildLookaheadFuncForOr(t,i,this.maxLookahead,a),this.classLAFuncs.put(n,r),r}return r},Parser.prototype.getLookaheadFuncForOption=function(t,e){var n=this.getKeyForAutomaticLookahead("OPTION",this.optionLookaheadKeys,t);return this.getLookaheadFuncFor(n,t,p.buildLookaheadForOption,this.maxLookahead,e)},Parser.prototype.getLookaheadFuncForMany=function(t,e){var n=this.getKeyForAutomaticLookahead("MANY",this.manyLookaheadKeys,t);return this.getLookaheadFuncFor(n,t,p.buildLookaheadForMany,this.maxLookahead,e)},Parser.prototype.getLookaheadFuncForManySep=function(t,e){var n=this.getKeyForAutomaticLookahead("MANY_SEP",this.manySepLookaheadKeys,t);return this.getLookaheadFuncFor(n,t,p.buildLookaheadForManySep,this.maxLookahead,e)},Parser.prototype.getLookaheadFuncForAtLeastOne=function(t,e){var n=this.getKeyForAutomaticLookahead("AT_LEAST_ONE",this.atLeastOneLookaheadKeys,t);return this.getLookaheadFuncFor(n,t,p.buildLookaheadForAtLeastOne,this.maxLookahead,e)},Parser.prototype.getLookaheadFuncForAtLeastOneSep=function(t,e){var n=this.getKeyForAutomaticLookahead("AT_LEAST_ONE_SEP",this.atLeastOneSepLookaheadKeys,t);return this.getLookaheadFuncFor(n,t,p.buildLookaheadForAtLeastOneSep,this.maxLookahead,e)},Parser.prototype.getLookaheadFuncFor=function(t,e,n,r,o){var i=this.classLAFuncs.get(t);if(void 0===i){var a=c.last(this.RULE_STACK),s=this.getGAstProductions().get(a);if(i=n.apply(null,[e,s,r]),o){var u=function(){return o.call(this)&&i.call(this)};return this.classLAFuncs.put(t,u),u}return this.classLAFuncs.put(t,i),i}return i},Parser.prototype.raiseNoAltException=function(t,e){var n=" but found: '"+this.LA(1).image+"'";if(void 0===e){var r=c.last(this.RULE_STACK),i=this.getGAstProductions().get(r),a=p.getLookaheadPathsForOr(t,i,this.maxLookahead),s=c.reduce(a,function(t,e){return t.concat(e)},[]),u=c.map(s,function(t){return"["+c.map(t,function(t){return l.tokenLabel(t)}).join(",")+"]"});e="one of these possible Token sequences:\n  <"+u.join(" ,")+">"}throw this.SAVE_ERROR(new o.exceptions.NoViableAltException("Expecting: "+e+" "+n,this.LA(1)))},Parser.prototype.raiseEarlyExitException=function(t,e,n){var r=" but found: '"+this.LA(1).image+"'";if(void 0===n){var i=c.last(this.RULE_STACK),a=this.getGAstProductions().get(i),s=p.getLookaheadPathsForOptionalProd(t,a,e,this.maxLookahead),u=s[0],f=c.map(u,function(t){return"["+c.map(t,function(t){return l.tokenLabel(t)}).join(",")+"]"});n="expecting at least one iteration which starts with one of these possible Token sequences::\n  "+("<"+f.join(" ,")+">")}else n="Expecting at least one "+n;throw this.SAVE_ERROR(new o.exceptions.EarlyExitException(n+r,this.LA(1)))},Parser.NO_RESYNC=!1,Parser.DEFER_DEFINITION_ERRORS_HANDLING=!1,Parser}();e.Parser=y,InRuleRecoveryException.prototype=Error.prototype},function(t,e,n){"use strict";function getProductionsForClass(t){return getFromNestedHashTable(t,e.CLASS_TO_GRAMMAR_PRODUCTIONS)}function getResyncFollowsForClass(t){return getFromNestedHashTable(t,e.CLASS_TO_RESYNC_FOLLOW_SETS)}function setResyncFollowsForClass(t,n){e.CLASS_TO_RESYNC_FOLLOW_SETS.put(t,n)}function getLookaheadFuncsForClass(t){return getFromNestedHashTable(t,e.CLASS_TO_LOOKAHEAD_FUNCS)}function getFirstAfterRepForClass(t){return getFromNestedHashTable(t,e.CLASS_TO_FIRST_AFTER_REPETITION)}function getProductionOverriddenForClass(t){return getFromNestedHashTable(t,e.CLASS_TO_PRODUCTION_OVERRIDEN)}function initLookAheadKeyCache(t){e.CLASS_TO_OR_LA_CACHE[t]=new Array(e.MAX_OCCURRENCE_INDEX),e.CLASS_TO_MANY_LA_CACHE[t]=new Array(e.MAX_OCCURRENCE_INDEX),e.CLASS_TO_MANY_SEP_LA_CACHE[t]=new Array(e.MAX_OCCURRENCE_INDEX),e.CLASS_TO_AT_LEAST_ONE_LA_CACHE[t]=new Array(e.MAX_OCCURRENCE_INDEX),e.CLASS_TO_AT_LEAST_ONE_SEP_LA_CACHE[t]=new Array(e.MAX_OCCURRENCE_INDEX),e.CLASS_TO_OPTION_LA_CACHE[t]=new Array(e.MAX_OCCURRENCE_INDEX),initSingleLookAheadKeyCache(e.CLASS_TO_OR_LA_CACHE[t]),initSingleLookAheadKeyCache(e.CLASS_TO_MANY_LA_CACHE[t]),initSingleLookAheadKeyCache(e.CLASS_TO_MANY_SEP_LA_CACHE[t]),initSingleLookAheadKeyCache(e.CLASS_TO_AT_LEAST_ONE_LA_CACHE[t]),initSingleLookAheadKeyCache(e.CLASS_TO_AT_LEAST_ONE_SEP_LA_CACHE[t]),initSingleLookAheadKeyCache(e.CLASS_TO_OPTION_LA_CACHE[t])}function initSingleLookAheadKeyCache(t){for(var n=0;n<e.MAX_OCCURRENCE_INDEX;n++)t[n]=new r.HashTable}function getFromNestedHashTable(t,e){var n=e.get(t);return void 0===n&&(e.put(t,new r.HashTable),n=e.get(t)),n}function clearCache(){var e=o.filter(o.values(t.exports),function(t){return t instanceof r.HashTable});o.forEach(e,function(t){return t.clear()})}var r=n(3),o=n(4);e.CLASS_TO_DEFINITION_ERRORS=new r.HashTable,e.CLASS_TO_SELF_ANALYSIS_DONE=new r.HashTable,e.CLASS_TO_GRAMMAR_PRODUCTIONS=new r.HashTable,e.getProductionsForClass=getProductionsForClass,e.CLASS_TO_RESYNC_FOLLOW_SETS=new r.HashTable,e.getResyncFollowsForClass=getResyncFollowsForClass,e.setResyncFollowsForClass=setResyncFollowsForClass,e.CLASS_TO_LOOKAHEAD_FUNCS=new r.HashTable,e.getLookaheadFuncsForClass=getLookaheadFuncsForClass,e.CLASS_TO_FIRST_AFTER_REPETITION=new r.HashTable,e.getFirstAfterRepForClass=getFirstAfterRepForClass,e.CLASS_TO_PRODUCTION_OVERRIDEN=new r.HashTable,e.getProductionOverriddenForClass=getProductionOverriddenForClass,e.CLASS_TO_OR_LA_CACHE=new r.HashTable,e.CLASS_TO_MANY_LA_CACHE=new r.HashTable,e.CLASS_TO_MANY_SEP_LA_CACHE=new r.HashTable,e.CLASS_TO_AT_LEAST_ONE_LA_CACHE=new r.HashTable,e.CLASS_TO_AT_LEAST_ONE_SEP_LA_CACHE=new r.HashTable,e.CLASS_TO_OPTION_LA_CACHE=new r.HashTable,e.MAX_OCCURRENCE_INDEX=5,e.initLookAheadKeyCache=initLookAheadKeyCache,e.clearCache=clearCache},function(t,e,n){"use strict";function classNameFromInstance(t){return functionName(t.constructor)}function functionName(t){var n=t.name;if(n)return n;var r=t[e.SPECIAL_NAME_CACHE_KEY];if(r)return r;var o=t.toString().match(i)[1];return defineNameProp(t,o)||(t[e.SPECIAL_NAME_CACHE_KEY]=o),o}function defineNameProp(t,e){var n=Object.getOwnPropertyDescriptor(t,a);return o.isUndefined(n)||n.configurable?(Object.defineProperty(t,a,{enumerable:!1,configurable:!0,writable:!1,value:e}),!0):!1}var r=n(4),o=n(4);e.classNameFromInstance=classNameFromInstance;var i=/^\s*function\s*(\S*)\s*\(/,a="name";e.SPECIAL_NAME_CACHE_KEY="CHEV_FUNC_NAME_CACHE666",e.functionName=functionName,e.defineNameProp=defineNameProp;var s=function(){function HashTable(){this._state={}}return HashTable.prototype.keys=function(){return r.keys(this._state)},HashTable.prototype.values=function(){return r.values(this._state)},HashTable.prototype.put=function(t,e){this._state[t]=e},HashTable.prototype.putAll=function(t){this._state=r.assign(this._state,t._state)},HashTable.prototype.get=function(t){return this._state[t]},HashTable.prototype.containsKey=function(t){return r.has(this._state,t)},HashTable.prototype.clear=function(){this._state={}},HashTable}();e.HashTable=s},function(t,e){"use strict";function isEmpty(t){return t&&0===t.length}function keys(t){return Object.keys(t)}function values(t){for(var e=[],n=Object.keys(t),r=0;r<n.length;r++)e.push(t[n[r]]);return e}function map(t,e){for(var n=[],r=0;r<t.length;r++)n.push(e.call(null,t[r],r));return n}function flatten(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];Array.isArray(r)?e=e.concat(flatten(r)):e.push(r)}return e}function first(t){return isEmpty(t)?void 0:t[0]}function last(t){var e=t&&t.length;return e?t[e-1]:void 0}function forEach(t,e){if(Array.isArray(t))for(var n=0;n<t.length;n++)e.call(null,t[n],n);else{if(!isObject(t))throw Error("non exhaustive match");for(var r=keys(t),n=0;n<r.length;n++){var o=r[n],i=t[o];e.call(null,i,o)}}}function isString(t){return"string"==typeof t}function isUndefined(t){return void 0===t}function isFunction(t){return t instanceof Function}function drop(t,e){return void 0===e&&(e=1),t.slice(e,t.length)}function dropRight(t,e){return void 0===e&&(e=1),t.slice(0,t.length-e)}function filter(t,e){var n=[];if(Array.isArray(t))for(var r=0;r<t.length;r++){var o=t[r];e.call(null,o)&&n.push(o)}return n}function reject(t,e){return filter(t,function(t){return!e(t)})}function pick(t,e){for(var n=Object.keys(t),r={},o=0;o<n.length;o++){var i=n[o],a=t[i];e(a)&&(r[i]=a)}return r}function has(t,e){return t.hasOwnProperty(e)}function contains(t,e){return void 0!==find(t,function(t){return t===e})}function cloneArr(t){return map(t,function(t){return t})}function cloneObj(t){var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function find(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(e.call(null,r))return r}}function reduce(t,e,n){for(var r=Array.isArray(t)?t:values(t),o=n,i=0;i<r.length;i++)o=e.call(null,o,r[i],i);return o}function compact(t){return reject(t,function(t){return null===t||void 0===t})}function uniq(t,e){void 0===e&&(e=function(t){return t});var n=[];return reduce(t,function(t,r){var o=e(r);return contains(n,o)?t:(n.push(o),t.concat(r))},[])}function partial(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=[null],o=r.concat(e);return Function.bind.apply(t,o)}function isArray(t){return Array.isArray(t)}function isRegExp(t){return t instanceof RegExp}function isObject(t){return t instanceof Object}function every(t,e){for(var n=0;n<t.length;n++)if(!e(t[n],n))return!1;return!0}function difference(t,e){return reject(t,function(t){return contains(e,t)})}function some(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function indexOf(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1}function sortBy(t,e){var n=cloneArr(t);return n.sort(function(t,n){return e(t)-e(n)}),n}function zipObject(t,e){if(t.length!==e.length)throw Error("can't zipObject with different number of keys and values!");for(var n={},r=0;r<t.length;r++)n[t[r]]=e[r];return n}function assign(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];
for(var r=0;r<e.length;r++)for(var o=e[r],i=keys(o),a=0;a<i.length;a++){var s=i[a];t[s]=o[s]}return t}function groupBy(t,e){var n={};return forEach(t,function(t){var r=e(t),o=n[r];o?o.push(t):n[r]=[t]}),n}function merge(t,e){for(var n=cloneObj(t),r=keys(e),o=0;o<r.length;o++){var i=r[o],a=e[i];n[i]=a}return n}e.isEmpty=isEmpty,e.keys=keys,e.values=values,e.map=map,e.flatten=flatten,e.first=first,e.last=last,e.forEach=forEach,e.isString=isString,e.isUndefined=isUndefined,e.isFunction=isFunction,e.drop=drop,e.dropRight=dropRight,e.filter=filter,e.reject=reject,e.pick=pick,e.has=has,e.contains=contains,e.cloneArr=cloneArr,e.cloneObj=cloneObj,e.find=find,e.reduce=reduce,e.compact=compact,e.uniq=uniq,e.partial=partial,e.isArray=isArray,e.isRegExp=isRegExp,e.isObject=isObject,e.every=every,e.difference=difference,e.some=some,e.indexOf=indexOf,e.sortBy=sortBy,e.zipObject=zipObject,e.assign=assign,e.groupBy=groupBy,e.merge=merge},function(t,e,n){"use strict";var r,o=n(3),i=n(4);!function(t){function isRecognitionException(t){var e=[o.functionName(MismatchedTokenException),o.functionName(NoViableAltException),o.functionName(EarlyExitException),o.functionName(NotAllInputParsedException)];return i.contains(e,t.name)}function MismatchedTokenException(t,e){this.name=o.functionName(MismatchedTokenException),this.message=t,this.token=e,this.resyncedTokens=[]}function NoViableAltException(t,e){this.name=o.functionName(NoViableAltException),this.message=t,this.token=e,this.resyncedTokens=[]}function NotAllInputParsedException(t,e){this.name=o.functionName(NotAllInputParsedException),this.message=t,this.token=e,this.resyncedTokens=[]}function EarlyExitException(t,e){this.name=o.functionName(EarlyExitException),this.message=t,this.token=e,this.resyncedTokens=[]}t.isRecognitionException=isRecognitionException,t.MismatchedTokenException=MismatchedTokenException,MismatchedTokenException.prototype=Error.prototype,t.NoViableAltException=NoViableAltException,NoViableAltException.prototype=Error.prototype,t.NotAllInputParsedException=NotAllInputParsedException,NotAllInputParsedException.prototype=Error.prototype,t.EarlyExitException=EarlyExitException,EarlyExitException.prototype=Error.prototype}(r=e.exceptions||(e.exceptions={}))},function(t,e,n){"use strict";function resolveGrammar(t){var e=new s(t);return e.resolveRefs(),e.errors}var r=this&&this.__extends||function(t,e){function __(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)},o=n(1),i=n(7),a=n(4);e.resolveGrammar=resolveGrammar;var s=function(t){function GastRefResolverVisitor(e){t.call(this),this.nameToTopRule=e,this.errors=[]}return r(GastRefResolverVisitor,t),GastRefResolverVisitor.prototype.resolveRefs=function(){var t=this;a.forEach(this.nameToTopRule.values(),function(e){t.currTopLevel=e,e.accept(t)})},GastRefResolverVisitor.prototype.visitNonTerminal=function(t){var e=this.nameToTopRule.get(t.nonTerminalName);if(e)t.referencedRule=e;else{var n="Invalid grammar, reference to a rule which is not defined: ->"+t.nonTerminalName+"<-\ninside top level rule: ->"+this.currTopLevel.name+"<-";this.errors.push({message:n,type:o.ParserDefinitionErrorType.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:t.nonTerminalName})}},GastRefResolverVisitor}(i.gast.GAstVisitor);e.GastRefResolverVisitor=s},function(t,e,n){"use strict";var r,o=this&&this.__extends||function(t,e){function __(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)},i=n(4);!function(t){var e=function(){function AbstractProduction(t){this.definition=t,this.implicitOccurrenceIndex=!1}return AbstractProduction.prototype.accept=function(t){t.visit(this),i.forEach(this.definition,function(e){e.accept(t)})},AbstractProduction}();t.AbstractProduction=e;var n=function(t){function NonTerminal(e,n,r){void 0===n&&(n=void 0),void 0===r&&(r=1),t.call(this,[]),this.nonTerminalName=e,this.referencedRule=n,this.occurrenceInParent=r}return o(NonTerminal,t),Object.defineProperty(NonTerminal.prototype,"definition",{get:function(){return void 0!==this.referencedRule?this.referencedRule.definition:[]},set:function(t){},enumerable:!0,configurable:!0}),NonTerminal.prototype.accept=function(t){t.visit(this)},NonTerminal}(e);t.NonTerminal=n;var r=function(t){function Rule(e,n,r){void 0===r&&(r=""),t.call(this,n),this.name=e,this.orgText=r}return o(Rule,t),Rule}(e);t.Rule=r;var a=function(t){function Flat(e){t.call(this,e)}return o(Flat,t),Flat}(e);t.Flat=a;var s=function(t){function Option(e,n){void 0===n&&(n=1),t.call(this,e),this.occurrenceInParent=n}return o(Option,t),Option}(e);t.Option=s;var c=function(t){function RepetitionMandatory(e,n){void 0===n&&(n=1),t.call(this,e),this.occurrenceInParent=n}return o(RepetitionMandatory,t),RepetitionMandatory}(e);t.RepetitionMandatory=c;var u=function(t){function RepetitionMandatoryWithSeparator(e,n,r){void 0===r&&(r=1),t.call(this,e),this.separator=n,this.occurrenceInParent=r}return o(RepetitionMandatoryWithSeparator,t),RepetitionMandatoryWithSeparator}(e);t.RepetitionMandatoryWithSeparator=u;var l=function(t){function Repetition(e,n){void 0===n&&(n=1),t.call(this,e),this.occurrenceInParent=n}return o(Repetition,t),Repetition}(e);t.Repetition=l;var p=function(t){function RepetitionWithSeparator(e,n,r){void 0===r&&(r=1),t.call(this,e),this.separator=n,this.occurrenceInParent=r}return o(RepetitionWithSeparator,t),RepetitionWithSeparator}(e);t.RepetitionWithSeparator=p;var f=function(t){function Alternation(e,n){void 0===n&&(n=1),t.call(this,e),this.occurrenceInParent=n}return o(Alternation,t),Alternation}(e);t.Alternation=f;var h=function(){function Terminal(t,e){void 0===e&&(e=1),this.terminalType=t,this.occurrenceInParent=e,this.implicitOccurrenceIndex=!1}return Terminal.prototype.accept=function(t){t.visit(this)},Terminal}();t.Terminal=h;var d=function(){function GAstVisitor(){}return GAstVisitor.prototype.visit=function(t){if(t instanceof n)return this.visitNonTerminal(t);if(t instanceof a)return this.visitFlat(t);if(t instanceof s)return this.visitOption(t);if(t instanceof c)return this.visitRepetitionMandatory(t);if(t instanceof u)return this.visitRepetitionMandatoryWithSeparator(t);if(t instanceof p)return this.visitRepetitionWithSeparator(t);if(t instanceof l)return this.visitRepetition(t);if(t instanceof f)return this.visitAlternation(t);if(t instanceof h)return this.visitTerminal(t);if(t instanceof r)return this.visitRule(t);throw Error("non exhaustive match")},GAstVisitor.prototype.visitNonTerminal=function(t){},GAstVisitor.prototype.visitFlat=function(t){},GAstVisitor.prototype.visitOption=function(t){},GAstVisitor.prototype.visitRepetition=function(t){},GAstVisitor.prototype.visitRepetitionMandatory=function(t){},GAstVisitor.prototype.visitRepetitionMandatoryWithSeparator=function(t){},GAstVisitor.prototype.visitRepetitionWithSeparator=function(t){},GAstVisitor.prototype.visitAlternation=function(t){},GAstVisitor.prototype.visitTerminal=function(t){},GAstVisitor.prototype.visitRule=function(t){},GAstVisitor}();t.GAstVisitor=d}(r=e.gast||(e.gast={}))},function(t,e,n){"use strict";function validateGrammar(t,e,n){var r=o.map(t,validateDuplicateProductions),i=o.map(t,function(t){return validateNoLeftRecursion(t,t)}),a=p.map(t,validateEmptyOrAlternative),s=p.map(t,function(t){return validateAmbiguousAlternationAlternatives(t,e,n)});return o.flatten(r.concat(i,a,s))}function validateDuplicateProductions(t){var e=new f;t.accept(e);var n=e.allProductions,r=o.groupBy(n,identifyProductionForDuplicates),a=o.pick(r,function(t){return t.length>1}),c=o.map(o.values(a),function(e){var n=o.first(e),r=createDuplicatesErrorMessage(e,t.name),a=s.getProductionDslName(n),c={message:r,type:i.ParserDefinitionErrorType.DUPLICATE_PRODUCTIONS,ruleName:t.name,dslName:a,occurrence:n.occurrenceInParent},u=getExtraProductionArgument(n);return u&&(c.parameter=u),c});return c}function createDuplicatesErrorMessage(t,e){var n=o.first(t),r=n.occurrenceInParent,i=s.getProductionDslName(n),a=getExtraProductionArgument(n),c="->"+i+"<- with occurrence index: ->"+r+"<-\n                  "+(a?"and argument: "+a:"")+"\n                  appears more than once ("+t.length+" times) in the top level rule: "+e+".\n                  "+(1===r?"note that "+i+" and "+i+"1 both have the same occurrence index 1}":"")+"}\n                  to fix this make sure each usage of "+i+" "+(a?"with the argument: "+a:"")+"\n                  in the rule "+e+" has a different occurrence index (1-5), as that combination acts as a unique\n                  position key in the grammar, which is needed by the parsing engine.";return c=c.replace(/[ \t]+/g," "),c=c.replace(/\s\s+/g,"\n")}function identifyProductionForDuplicates(t){return s.getProductionDslName(t)+"_#_"+t.occurrenceInParent+"_#_"+getExtraProductionArgument(t)}function getExtraProductionArgument(t){return t instanceof a.gast.Terminal?c.tokenName(t.terminalType):t instanceof a.gast.NonTerminal?t.nonTerminalName:""}function validateRuleName(t,e){var n,r=[];return t.match(h)||(n="Invalid Grammar rule name: ->"+t+"<- it must match the pattern: ->"+h.toString()+"<-",r.push({message:n,type:i.ParserDefinitionErrorType.INVALID_RULE_NAME,ruleName:t})),r}function validateRuleDoesNotAlreadyExist(t,e,n){var r,a=[];return o.contains(e,t)&&(r="Duplicate definition, rule: ->"+t+"<- is already defined in the grammar: ->"+n+"<-",a.push({message:r,type:i.ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:t})),a}function validateRuleIsOverridden(t,e,n){var r,a=[];return o.contains(e,t)||(r="Invalid rule override, rule: ->"+t+"<- cannot be overridden in the grammar: ->"+n+"<-as it is not defined in any of the super grammars ",a.push({message:r,type:i.ParserDefinitionErrorType.INVALID_RULE_OVERRIDE,ruleName:t})),a}function validateNoLeftRecursion(t,e,n){void 0===n&&(n=[]);var r=[],a=getFirstNoneTerminal(e.definition);if(o.isEmpty(a))return[];var s=t.name,c=o.contains(a,t),u=o.map(n,function(t){return t.name}),l=s+" --> "+u.concat([s]).join(" --> ");if(c){var p="Left Recursion found in grammar.\n"+("rule: <"+s+"> can be invoked from itself (directly or indirectly)\n")+("without consuming any Tokens. The grammar path that causes this is: \n "+l+"\n")+" To fix this refactor your grammar to remove the left recursion.\nsee: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring.";r.push({message:p,type:i.ParserDefinitionErrorType.LEFT_RECURSION,ruleName:s})}var f=o.difference(a,n.concat([t])),h=o.map(f,function(e){var r=o.cloneArr(n);return r.push(e),validateNoLeftRecursion(t,e,r)});return r.concat(o.flatten(h))}function getFirstNoneTerminal(t){var e=[];if(o.isEmpty(t))return e;var n=o.first(t);if(n instanceof a.gast.NonTerminal)e.push(n.referencedRule);else if(n instanceof a.gast.Flat||n instanceof a.gast.Option||n instanceof a.gast.RepetitionMandatory||n instanceof a.gast.RepetitionMandatoryWithSeparator||n instanceof a.gast.RepetitionWithSeparator||n instanceof a.gast.Repetition)e=e.concat(getFirstNoneTerminal(n.definition));else if(n instanceof a.gast.Alternation)e=o.flatten(o.map(n.definition,function(t){return getFirstNoneTerminal(t.definition)}));else if(!(n instanceof a.gast.Terminal))throw Error("non exhaustive match");var r=s.isOptionalProd(n),i=t.length>1;if(r&&i){var c=o.drop(t);return e.concat(getFirstNoneTerminal(c))}return e}function validateEmptyOrAlternative(t){var e=new d;t.accept(e);var n=e.alternations,r=o.reduce(n,function(e,n){var r=o.dropRight(n.definition),a=o.map(r,function(e,r){return o.isEmpty(u.first(e))?{message:"Ambiguous empty alternative: <"+(r+1)+">"+(" in <OR"+n.occurrenceInParent+"> inside <"+t.name+"> Rule.\n")+"Only the last alternative may be an empty alternative.",type:i.ParserDefinitionErrorType.NONE_LAST_EMPTY_ALT,ruleName:t.name,occurrence:n.occurrenceInParent,alternative:r+1}:null});return e.concat(o.compact(a))},[]);return r}function validateAmbiguousAlternationAlternatives(t,e,n){var r=new d;t.accept(r);var a=r.alternations,u=n[t.name];u&&(a=p.reject(a,function(t){return u[s.getProductionDslName(t)+t.occurrenceInParent]}));var f=o.reduce(a,function(n,r){var a=r.occurrenceInParent,s=l.getLookaheadPathsForOr(a,t,e),u=checkAlternativesAmbiguities(s),f=o.map(u,function(e){var n=p.map(e.alts,function(t){return t+1}),o=p.map(e.path,function(t){return c.tokenLabel(t)}).join(", "),s="Ambiguous alternatives: <"+n.join(" ,")+"> in <OR"+a+">"+(" inside <"+t.name+"> Rule,\n")+("<"+o+"> may appears as a prefix path in all these alternatives.\n");return s+="To Resolve this, try one of of the following: \n1. Refactor your grammar to be LL(K) for the current value of k (by default k=5)\n2. Increase the value of K for your grammar by providing a larger 'maxLookahead' value in the parser's config\n3. This issue can be ignored (if you know what you are doing...), see http://sap.github.io/chevrotain/documentation/0_9_0/interfaces/iparserconfig.html for\n",{message:s,type:i.ParserDefinitionErrorType.AMBIGUOUS_ALTS,ruleName:t.name,occurrence:r.occurrenceInParent,alternatives:[e.alts]}});return n.concat(f)},[]);return f}function checkAlternativesAmbiguities(t){var e=[],n=p.reduce(t,function(n,r,o){return p.forEach(r,function(r){var i=[o];p.forEach(t,function(t,e){o!==e&&l.containsPath(t,r)&&i.push(e)}),i.length>1&&!l.containsPath(e,r)&&(e.push(r),n.push({alts:i,path:r}))}),n},[]);return n}var r=this&&this.__extends||function(t,e){function __(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)},o=n(4),i=n(1),a=n(7),s=n(9),c=n(10),u=n(13),l=n(14),p=n(4);e.validateGrammar=validateGrammar,e.identifyProductionForDuplicates=identifyProductionForDuplicates;var f=function(t){function OccurrenceValidationCollector(){t.apply(this,arguments),this.allProductions=[]}return r(OccurrenceValidationCollector,t),OccurrenceValidationCollector.prototype.visitNonTerminal=function(t){this.allProductions.push(t)},OccurrenceValidationCollector.prototype.visitOption=function(t){this.allProductions.push(t)},OccurrenceValidationCollector.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},OccurrenceValidationCollector.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},OccurrenceValidationCollector.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},OccurrenceValidationCollector.prototype.visitRepetition=function(t){this.allProductions.push(t)},OccurrenceValidationCollector.prototype.visitAlternation=function(t){this.allProductions.push(t)},OccurrenceValidationCollector.prototype.visitTerminal=function(t){this.allProductions.push(t)},OccurrenceValidationCollector}(a.gast.GAstVisitor);e.OccurrenceValidationCollector=f;var h=/^[a-zA-Z_]\w*$/;e.validateRuleName=validateRuleName,e.validateRuleDoesNotAlreadyExist=validateRuleDoesNotAlreadyExist,e.validateRuleIsOverridden=validateRuleIsOverridden,e.validateNoLeftRecursion=validateNoLeftRecursion,e.getFirstNoneTerminal=getFirstNoneTerminal;var d=function(t){function OrCollector(){t.apply(this,arguments),this.alternations=[]}return r(OrCollector,t),OrCollector.prototype.visitAlternation=function(t){this.alternations.push(t)},OrCollector}(a.gast.GAstVisitor);e.validateEmptyOrAlternative=validateEmptyOrAlternative,e.validateAmbiguousAlternationAlternatives=validateAmbiguousAlternationAlternatives},function(t,e,n){"use strict";function isSequenceProd(t){return t instanceof o.gast.Flat||t instanceof o.gast.Option||t instanceof o.gast.Repetition||t instanceof o.gast.RepetitionMandatory||t instanceof o.gast.RepetitionMandatoryWithSeparator||t instanceof o.gast.RepetitionWithSeparator||t instanceof o.gast.Terminal||t instanceof o.gast.Rule}function isOptionalProd(t,e){void 0===e&&(e=[]);var n=t instanceof o.gast.Option||t instanceof o.gast.Repetition||t instanceof o.gast.RepetitionWithSeparator;return n?!0:t instanceof o.gast.Alternation?i.some(t.definition,function(t){return isOptionalProd(t,e)}):t instanceof o.gast.NonTerminal&&i.contains(e,t)?!1:t instanceof o.gast.AbstractProduction?(t instanceof o.gast.NonTerminal&&e.push(t),i.every(t.definition,function(t){return isOptionalProd(t,e)})):!1}function isBranchingProd(t){return t instanceof o.gast.Alternation}function getProductionDslName(t){var e=t.constructor,n=a.functionName(e);return s[n]}function cloneProduction(t){var e=new c;return e.visit(t)}var r=this&&this.__extends||function(t,e){function __(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)},o=n(7),i=n(4),a=n(3);e.isSequenceProd=isSequenceProd,e.isOptionalProd=isOptionalProd,e.isBranchingProd=isBranchingProd;var s={};s[a.functionName(o.gast.NonTerminal)]="SUBRULE",s[a.functionName(o.gast.Option)]="OPTION",s[a.functionName(o.gast.RepetitionMandatory)]="AT_LEAST_ONE",s[a.functionName(o.gast.RepetitionMandatoryWithSeparator)]="AT_LEAST_ONE_SEP",s[a.functionName(o.gast.RepetitionWithSeparator)]="MANY_SEP",s[a.functionName(o.gast.Repetition)]="MANY",s[a.functionName(o.gast.Alternation)]="OR",s[a.functionName(o.gast.Terminal)]="CONSUME",e.getProductionDslName=getProductionDslName;var c=function(t){function GastCloneVisitor(){t.apply(this,arguments)}return r(GastCloneVisitor,t),GastCloneVisitor.prototype.visitNonTerminal=function(t){return new o.gast.NonTerminal(t.nonTerminalName,void 0,t.occurrenceInParent)},GastCloneVisitor.prototype.visitFlat=function(t){var e=this,n=i.map(t.definition,function(t){return e.visit(t)});return new o.gast.Flat(n)},GastCloneVisitor.prototype.visitOption=function(t){var e=this,n=i.map(t.definition,function(t){return e.visit(t)});return new o.gast.Option(n,t.occurrenceInParent)},GastCloneVisitor.prototype.visitRepetition=function(t){var e=this,n=i.map(t.definition,function(t){return e.visit(t)});return new o.gast.Repetition(n,t.occurrenceInParent)},GastCloneVisitor.prototype.visitRepetitionMandatory=function(t){var e=this,n=i.map(t.definition,function(t){return e.visit(t)});return new o.gast.RepetitionMandatory(n,t.occurrenceInParent)},GastCloneVisitor.prototype.visitRepetitionMandatoryWithSeparator=function(t){var e=this,n=i.map(t.definition,function(t){return e.visit(t)});return new o.gast.RepetitionMandatoryWithSeparator(n,t.separator,t.occurrenceInParent)},GastCloneVisitor.prototype.visitRepetitionWithSeparator=function(t){var e=this,n=i.map(t.definition,function(t){return e.visit(t)});return new o.gast.RepetitionWithSeparator(n,t.separator,t.occurrenceInParent)},GastCloneVisitor.prototype.visitAlternation=function(t){var e=this,n=i.map(t.definition,function(t){return e.visit(t)});return new o.gast.Alternation(n,t.occurrenceInParent)},GastCloneVisitor.prototype.visitTerminal=function(t){return new o.gast.Terminal(t.terminalType,t.occurrenceInParent)},GastCloneVisitor.prototype.visitRule=function(t){var e=this,n=i.map(t.definition,function(t){return e.visit(t)});return new o.gast.Rule(t.name,n,t.orgText)},GastCloneVisitor}(o.gast.GAstVisitor);e.cloneProduction=cloneProduction},function(t,e,n){"use strict";function tokenLabel(t){return hasTokenLabel(t)?t.LABEL:tokenName(t)}function hasTokenLabel(t){return o.isString(t.LABEL)&&""!==t.LABEL}function tokenName(t){return o.isString(t.tokenName)?t.tokenName:i.functionName(t)}function extendToken(t,e,n){void 0===e&&(e=void 0),void 0===n&&(n=s);var r;o.isRegExp(e)||e===a.Lexer.SKIPPED||e===a.Lexer.NA?r=e:o.isFunction(e)&&(n=e,r=void 0);var c=function(){n.apply(this,arguments)};return c=o.assign(c,n),i.defineNameProp(c,t)||(c.tokenName=t),c.prototype=Object.create(n.prototype),c.prototype.constructor=c,o.isUndefined(r)||(c.PATTERN=r),c}var r=this&&this.__extends||function(t,e){function __(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)},o=n(4),i=n(3),a=n(11);e.tokenLabel=tokenLabel,e.hasTokenLabel=hasTokenLabel,e.tokenName=tokenName,e.extendToken=extendToken;var s=function(){function Token(t,e,n,r,o,i){void 0===o&&(o=n),void 0===i&&(i=r+t.length-1),this.image=t,this.offset=e,this.startLine=n,this.startColumn=r,this.endLine=o,this.endColumn=i,this.isInsertedInRecovery=!1}return Token.LABEL=void 0,Token}();e.Token=s;var c=function(t){function VirtualToken(){t.call(this,"",-1,-1,-1,-1,-1)}return r(VirtualToken,t),VirtualToken}(s);e.VirtualToken=c;var u=function(t){function EOF(){t.apply(this,arguments)}return r(EOF,t),EOF}(c);e.EOF=u},function(t,e,n){"use strict";var r=n(12),o=n(4);!function(t){t[t.MISSING_PATTERN=0]="MISSING_PATTERN",t[t.INVALID_PATTERN=1]="INVALID_PATTERN",t[t.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",t[t.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",t[t.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",t[t.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",t[t.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",t[t.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",t[t.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",t[t.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",t[t.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED"}(e.LexerDefinitionErrorType||(e.LexerDefinitionErrorType={}));var i=(e.LexerDefinitionErrorType,function(){function Lexer(t,e){var n=this;void 0===e&&(e=!1),this.lexerDefinition=t,this.lexerDefinitionErrors=[],this.modes=[],this.allPatterns={},this.patternIdxToClass={},this.patternIdxToGroup={},this.patternIdxToLongerAltIdx={},this.patternIdxToCanLineTerminator={},this.patternIdxToPushMode={},this.patternIdxToPopMode={},this.emptyGroups={};var i;o.isArray(t)?(i={modes:{}},i.modes[r.DEFAULT_MODE]=o.cloneArr(t),i[r.DEFAULT_MODE]=r.DEFAULT_MODE):i=o.cloneObj(t),this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(r.performRuntimeChecks(i)),i.modes=i.modes?i.modes:{},o.forEach(i.modes,function(t,e){i.modes[e]=o.reject(t,function(t){return o.isUndefined(t)})});var a=o.keys(i.modes);if(o.forEach(i.modes,function(t,e){if(n.modes.push(e),n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(r.validatePatterns(t,a)),o.isEmpty(n.lexerDefinitionErrors)){var i=r.analyzeTokenClasses(t);n.allPatterns[e]=i.allPatterns,n.patternIdxToClass[e]=i.patternIdxToClass,n.patternIdxToGroup[e]=i.patternIdxToGroup,n.patternIdxToLongerAltIdx[e]=i.patternIdxToLongerAltIdx,n.patternIdxToCanLineTerminator[e]=i.patternIdxToCanLineTerminator,n.patternIdxToPushMode[e]=i.patternIdxToPushMode,n.patternIdxToPopMode[e]=i.patternIdxToPopMode,n.emptyGroups=o.merge(n.emptyGroups,i.emptyGroups)}}),this.defaultMode=i.defaultMode,!o.isEmpty(this.lexerDefinitionErrors)&&!e){var s=o.map(this.lexerDefinitionErrors,function(t){return t.message}),c=s.join("-----------------------\n");throw new Error("Errors detected in definition of Lexer:\n"+c)}}return Lexer.prototype.tokenize=function(t,e){var n=this;if(void 0===e&&(e=this.defaultMode),!o.isEmpty(this.lexerDefinitionErrors)){var i=o.map(this.lexerDefinitionErrors,function(t){return t.message}),a=i.join("-----------------------\n");throw new Error("Unable to Tokenize because Errors detected in definition of Lexer:\n"+a)}var s,c,u,l,p,f,h,d,E,T,A,_,y,O,R,v,g,m=t,P=0,N=[],L=[],S=1,k=1,I=o.cloneObj(this.emptyGroups),F=[],x=0,C=[],M=[],b=[],w=[],D=[],U=[],W=[],V=function(t){if(1===W.length){var e="Unable to pop Lexer Mode after encountering Token ->"+t.image+"<- The Mode Stack is empty";L.push({line:t.startLine,column:t.startColumn,length:t.image.length,message:e})}else{W.pop();var r=o.last(W);F=n.allPatterns[r],x=F.length,C=n.patternIdxToLongerAltIdx[r],M=n.patternIdxToGroup[r],b=n.patternIdxToClass[r],w=n.patternIdxToCanLineTerminator[r],D=n.patternIdxToPushMode[r],U=n.patternIdxToPopMode[r]}},K=function(t){W.push(t),F=n.allPatterns[t],x=F.length,C=n.patternIdxToLongerAltIdx[t],M=n.patternIdxToGroup[t],b=n.patternIdxToClass[t],w=n.patternIdxToCanLineTerminator[t],D=n.patternIdxToPushMode[t],U=n.patternIdxToPopMode[t]};for(K(e);t.length>0;){for(s=null,c=0;x>c;c++)if(s=F[c].exec(t),null!==s){p=C[c],p&&(l=F[p].exec(t),l&&l[0].length>s[0].length&&(s=l,c=p));break}if(null!==s){if(f=s[0],h=f.length,d=M[c],void 0!==d&&(E=b[c],T=new E(f,P,S,k),"default"===d?N.push(T):I[d].push(T)),t=t.slice(h),P+=h,k+=h,w[c]){var H=r.countLineTerminators(f);if(0!==H){for(S+=H,R=h-1;R>=0&&(y=f.charCodeAt(R),13!==y&&10!==y);)R--;k=h-R,void 0!==d&&(g=R===h-1,_=g?-1:0,1===H&&g||(T.endLine=S+_,T.endColumn=k-1+-_))}}U[c]&&V(T),D[c]&&K(D[c])}else{for(var G=P,Y=S,j=k,B=!1;!B&&t.length>0;)for(O=t.charCodeAt(0),10===O||13===O&&(1===t.length||t.length>1&&10!==t.charCodeAt(1))?(S++,k=1):k++,t=t.substr(1),P++,u=0;u<F.length&&!(B=F[u].test(t));u++);A=P-G,v="unexpected character: ->"+m.charAt(G)+"<- at offset: "+G+","+(" skipped "+(P-G)+" characters."),L.push({line:Y,column:j,length:A,message:v})}}return{tokens:N,groups:I,errors:L}},Lexer.SKIPPED={description:"This marks a skipped Token pattern, this means each token identified by it willbe consumed and then throw into oblivion, this can be used to for example: skip whitespace."},Lexer.NA=/NOT_APPLICABLE/,Lexer}());e.Lexer=i},function(t,e,n){"use strict";function analyzeTokenClasses(t){var e=i.reject(t,function(t){return t[a]===o.Lexer.NA}),n=i.map(e,function(t){return addStartOfInput(t[a])}),r=i.zipObject(n,e),s=i.map(n,function(t){return r[t.toString()]}),c=i.map(e,function(t){var e=t.GROUP;if(e!==o.Lexer.SKIPPED){if(i.isString(e))return e;if(i.isUndefined(e))return"default";throw Error("non exhaustive match")}}),u=i.map(e,function(t){var n=t.LONGER_ALT;if(n){var r=i.indexOf(e,n);return r}}),l=i.map(e,function(t){return t.PUSH_MODE}),p=i.map(e,function(t){return i.has(t,"POP_MODE")}),f=i.map(n,function(t){return/\\n|\\r|\\s/g.test(t.source)}),h=i.reduce(e,function(t,e){var n=e.GROUP;return i.isString(n)&&(t[n]=[]),t},{});return{allPatterns:n,patternIdxToClass:s,patternIdxToGroup:c,patternIdxToLongerAltIdx:u,patternIdxToCanLineTerminator:f,patternIdxToPushMode:l,patternIdxToPopMode:p,emptyGroups:h}}function validatePatterns(t,e){var n=[],r=findMissingPatterns(t),o=r.valid;n=n.concat(r.errors);var i=findInvalidPatterns(o);return o=i.valid,n=n.concat(i.errors),n=n.concat(findEndOfInputAnchor(o)),n=n.concat(findUnsupportedFlags(o)),n=n.concat(findDuplicatePatterns(o)),n=n.concat(findInvalidGroupType(o)),n=n.concat(findModesThatDoNotExist(o,e))}function findMissingPatterns(t){var e=i.filter(t,function(t){return!i.has(t,a)}),n=i.map(e,function(t){return{message:"Token class: ->"+r.tokenName(t)+"<- missing static 'PATTERN' property",type:o.LexerDefinitionErrorType.MISSING_PATTERN,tokenClasses:[t]}}),s=i.difference(t,e);return{errors:n,valid:s}}function findInvalidPatterns(t){var e=i.filter(t,function(t){var e=t[a];return!i.isRegExp(e)}),n=i.map(e,function(t){return{message:"Token class: ->"+r.tokenName(t)+"<- static 'PATTERN' can only be a RegExp",type:o.LexerDefinitionErrorType.INVALID_PATTERN,tokenClasses:[t]}}),s=i.difference(t,e);return{errors:n,valid:s}}function findEndOfInputAnchor(t){var e=i.filter(t,function(t){var e=t[a];return s.test(e.source)}),n=i.map(e,function(t){return{message:"Token class: ->"+r.tokenName(t)+"<- static 'PATTERN' cannot contain end of input anchor '$'",type:o.LexerDefinitionErrorType.EOI_ANCHOR_FOUND,tokenClasses:[t]}});return n}function findUnsupportedFlags(t){var e=i.filter(t,function(t){var e=t[a];return e instanceof RegExp&&(e.multiline||e.global)}),n=i.map(e,function(t){return{message:"Token class: ->"+r.tokenName(t)+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:o.LexerDefinitionErrorType.UNSUPPORTED_FLAGS_FOUND,tokenClasses:[t]}});return n}function findDuplicatePatterns(t){var e=[],n=i.map(t,function(n){return i.reduce(t,function(t,r){return n.PATTERN.source!==r.PATTERN.source||i.contains(e,r)||r.PATTERN===o.Lexer.NA?t:(e.push(r),t.push(r),t)},[])});n=i.compact(n);var a=i.filter(n,function(t){return t.length>1}),s=i.map(a,function(t){var e=i.map(t,function(t){return r.tokenName(t)}),n=i.first(t).PATTERN;return{message:"The same RegExp pattern ->"+n+"<-"+("has been used in all the following classes: "+e.join(", ")+" <-"),type:o.LexerDefinitionErrorType.DUPLICATE_PATTERNS_FOUND,tokenClasses:t}});return s}function findInvalidGroupType(t){var e=i.filter(t,function(t){if(!i.has(t,"GROUP"))return!1;var e=t.GROUP;return e!==o.Lexer.SKIPPED&&e!==o.Lexer.NA&&!i.isString(e)}),n=i.map(e,function(t){return{message:"Token class: ->"+r.tokenName(t)+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:o.LexerDefinitionErrorType.INVALID_GROUP_TYPE_FOUND,tokenClasses:[t]}});return n}function findModesThatDoNotExist(t,e){var n=i.filter(t,function(t){return void 0!==t.PUSH_MODE&&!i.contains(e,t.PUSH_MODE)}),a=i.map(n,function(t){var e="Token class: ->"+r.tokenName(t)+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+t.PUSH_MODE+"<-which does not exist";return{message:e,type:o.LexerDefinitionErrorType.PUSH_MODE_DOES_NOT_EXIST,tokenClasses:[t]}});return a}function addStartOfInput(t){var e=t.ignoreCase?"i":"";return new RegExp("^(?:"+t.source+")",e)}function countLineTerminators(t){for(var e=0,n=0;n<t.length;){var r=t.charCodeAt(n);10===r?e++:13===r&&(n!==t.length-1&&10===t.charCodeAt(n+1)||e++),n++}return e}function performRuntimeChecks(t){var n=[];return i.has(t,e.DEFAULT_MODE)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+e.DEFAULT_MODE+"> property in its definition\n",type:o.LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),i.has(t,e.MODES)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+e.MODES+"> property in its definition\n",type:o.LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),i.has(t,e.MODES)&&i.has(t,e.DEFAULT_MODE)&&!i.has(t.modes,t.defaultMode)&&n.push({message:"A MultiMode Lexer cannot be initialized with a "+e.DEFAULT_MODE+": <"+t.defaultMode+">which does not exist\n",type:o.LexerDefinitionErrorType.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),i.has(t,e.MODES)&&i.forEach(t.modes,function(t,e){i.forEach(t,function(t,r){i.isUndefined(t)&&n.push({message:"A Lexer cannot be initialized using an undefined Token Class. Mode:"+("<"+e+"> at index: <"+r+">\n"),type:o.LexerDefinitionErrorType.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})})}),n}var r=n(10),o=n(11),i=n(4),a="PATTERN";e.DEFAULT_MODE="defaultMode",e.MODES="modes",e.analyzeTokenClasses=analyzeTokenClasses,e.validatePatterns=validatePatterns,e.findMissingPatterns=findMissingPatterns,e.findInvalidPatterns=findInvalidPatterns;var s=/[^\\][\$]/;e.findEndOfInputAnchor=findEndOfInputAnchor,e.findUnsupportedFlags=findUnsupportedFlags,e.findDuplicatePatterns=findDuplicatePatterns,e.findInvalidGroupType=findInvalidGroupType,e.findModesThatDoNotExist=findModesThatDoNotExist,e.addStartOfInput=addStartOfInput,e.countLineTerminators=countLineTerminators,e.performRuntimeChecks=performRuntimeChecks},function(t,e,n){"use strict";function first(t){if(t instanceof r.gast.NonTerminal)return first(t.referencedRule);if(t instanceof r.gast.Terminal)return firstForTerminal(t);if(o.isSequenceProd(t))return firstForSequence(t);if(o.isBranchingProd(t))return firstForBranching(t);throw Error("non exhaustive match")}function firstForSequence(t){for(var e,n=[],r=t.definition,a=0,s=r.length>a,c=!0;s&&c;)e=r[a],c=o.isOptionalProd(e),n=n.concat(first(e)),a+=1,s=r.length>a;return i.uniq(n)}function firstForBranching(t){var e=i.map(t.definition,function(t){return first(t)});return i.uniq(i.flatten(e))}function firstForTerminal(t){return[t.terminalType]}var r=n(7),o=n(9),i=n(4);e.first=first,e.firstForSequence=firstForSequence,e.firstForBranching=firstForBranching,e.firstForTerminal=firstForTerminal},function(t,e,n){"use strict";function buildLookaheadFuncForOr(t,e,n,r){void 0===r&&(r=[]);var o=getLookaheadPathsForOr(t,e,n);
return buildAlternativesLookAheadFunc(o,r)}function buildLookaheadForTopLevel(t,e){var n=a.possiblePathsFrom(t.definition,e),r=lookAheadSequenceFromAlternatives([n]);return buildSingleAlternativeLookaheadFunction(r[0])}function buildLookaheadFuncForOptionalProd(t,e,n,r){var o=getLookaheadPathsForOptionalProd(t,e,n,r);return buildSingleAlternativeLookaheadFunction(o[0])}function buildLookaheadForOption(t,e,n){return buildLookaheadFuncForOptionalProd(t,e,c.OPTION,n)}function buildLookaheadForMany(t,e,n){return buildLookaheadFuncForOptionalProd(t,e,c.REPETITION,n)}function buildLookaheadForManySep(t,e,n){return buildLookaheadFuncForOptionalProd(t,e,c.REPETITION_WITH_SEPARATOR,n)}function buildLookaheadForAtLeastOne(t,e,n){return buildLookaheadFuncForOptionalProd(t,e,c.REPETITION_MANDATORY,n)}function buildLookaheadForAtLeastOneSep(t,e,n){return buildLookaheadFuncForOptionalProd(t,e,c.REPETITION_MANDATORY_WITH_SEPARATOR,n)}function lookAheadSequenceFromAlternatives(t){function isUniquePrefix(t,e){return void 0===o.find(t,function(t){return o.every(e,function(e,n){return e===t[n]})})}var e=o.map(t,function(e,n){var r=o.reject(t,function(t){return t===e}),i=o.reduce(r,function(t,e){return t.concat(e)},[]);return o.reduce(e,function(t,e){for(var n=[],r=0;r<e.length;r++){n.push(e[r]);var o=isUniquePrefix(i,n);if(o)break}return containsPath(t,n)?t:(t.push(n),t)},[])});return e}function buildAlternativesLookAheadFunc(t,e){void 0===e&&(e=[]);var n=t.length;return o.some(e,function(t){return o.isFunction(t)})?function(){for(var r=0;n>r;r++){var o=t[r],i=o.length,a=e[r];if(!a||a.call(this))t:for(var s=0;i>s;s++){for(var c=o[s],u=c.length,l=0;u>l;l++){var p=this.LA(l+1);if(!(p instanceof c[l]))continue t}return r}}return-1}:function(){for(var e=0;n>e;e++){var r=t[e],o=r.length;t:for(var i=0;o>i;i++){for(var a=r[i],s=a.length,c=0;s>c;c++){var u=this.LA(c+1);if(!(u instanceof a[c]))continue t}return e}}return-1}}function buildSingleAlternativeLookaheadFunction(t){var e=t.length;return function(){t:for(var n=0;e>n;n++){for(var r=t[n],o=r.length,i=0;o>i;i++){var a=this.LA(i+1);if(!(a instanceof r[i]))continue t}return!0}return!1}}function getLookaheadPathsForOr(t,e,n){var r=new l(t,c.ALTERNATION);e.accept(r);var i=o.map(r.result,function(t){return a.possiblePathsFrom([t],n)});return lookAheadSequenceFromAlternatives(i)}function getLookaheadPathsForOptionalProd(t,e,n,r){var o=new l(t,n);e.accept(o);var i=o.result,s=new u(e,t,n),c=s.startWalking(),p=a.possiblePathsFrom(i,r),f=a.possiblePathsFrom(c,r);return lookAheadSequenceFromAlternatives([p,f])}function containsPath(t,e){var n=o.find(t,function(t){return e.length===t.length&&o.every(e,function(e,n){return e===t[n]})});return void 0!==n}var r=this&&this.__extends||function(t,e){function __(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)},o=n(4),i=n(7),a=n(15),s=n(16);!function(t){t[t.OPTION=0]="OPTION",t[t.REPETITION=1]="REPETITION",t[t.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",t[t.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",t[t.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",t[t.ALTERNATION=5]="ALTERNATION"}(e.PROD_TYPE||(e.PROD_TYPE={}));var c=e.PROD_TYPE;e.buildLookaheadFuncForOr=buildLookaheadFuncForOr,e.buildLookaheadForTopLevel=buildLookaheadForTopLevel,e.buildLookaheadFuncForOptionalProd=buildLookaheadFuncForOptionalProd,e.buildLookaheadForOption=buildLookaheadForOption,e.buildLookaheadForMany=buildLookaheadForMany,e.buildLookaheadForManySep=buildLookaheadForManySep,e.buildLookaheadForAtLeastOne=buildLookaheadForAtLeastOne,e.buildLookaheadForAtLeastOneSep=buildLookaheadForAtLeastOneSep,e.lookAheadSequenceFromAlternatives=lookAheadSequenceFromAlternatives,e.buildAlternativesLookAheadFunc=buildAlternativesLookAheadFunc,e.buildSingleAlternativeLookaheadFunction=buildSingleAlternativeLookaheadFunction;var u=function(t){function RestDefinitionFinderWalker(e,n,r){t.call(this),this.topProd=e,this.targetOccurrence=n,this.targetProdType=r}return r(RestDefinitionFinderWalker,t),RestDefinitionFinderWalker.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},RestDefinitionFinderWalker.prototype.checkIsTarget=function(t,e,n,r){return t.occurrenceInParent===this.targetOccurrence&&this.targetProdType===e?(this.restDef=n.concat(r),!0):!1},RestDefinitionFinderWalker.prototype.walkOption=function(e,n,r){this.checkIsTarget(e,c.OPTION,n,r)||t.prototype.walkOption.call(this,e,n,r)},RestDefinitionFinderWalker.prototype.walkAtLeastOne=function(e,n,r){this.checkIsTarget(e,c.REPETITION_MANDATORY,n,r)||t.prototype.walkOption.call(this,e,n,r)},RestDefinitionFinderWalker.prototype.walkAtLeastOneSep=function(e,n,r){this.checkIsTarget(e,c.REPETITION_MANDATORY_WITH_SEPARATOR,n,r)||t.prototype.walkOption.call(this,e,n,r)},RestDefinitionFinderWalker.prototype.walkMany=function(e,n,r){this.checkIsTarget(e,c.REPETITION,n,r)||t.prototype.walkOption.call(this,e,n,r)},RestDefinitionFinderWalker.prototype.walkManySep=function(e,n,r){this.checkIsTarget(e,c.REPETITION_WITH_SEPARATOR,n,r)||t.prototype.walkOption.call(this,e,n,r)},RestDefinitionFinderWalker}(s.RestWalker),l=function(t){function InsideDefinitionFinderVisitor(e,n){t.call(this),this.targetOccurrence=e,this.targetProdType=n,this.result=[]}return r(InsideDefinitionFinderVisitor,t),InsideDefinitionFinderVisitor.prototype.checkIsTarget=function(t,e){t.occurrenceInParent===this.targetOccurrence&&this.targetProdType===e&&(this.result=t.definition)},InsideDefinitionFinderVisitor.prototype.visitOption=function(t){this.checkIsTarget(t,c.OPTION)},InsideDefinitionFinderVisitor.prototype.visitRepetition=function(t){this.checkIsTarget(t,c.REPETITION)},InsideDefinitionFinderVisitor.prototype.visitRepetitionMandatory=function(t){this.checkIsTarget(t,c.REPETITION_MANDATORY)},InsideDefinitionFinderVisitor.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.checkIsTarget(t,c.REPETITION_MANDATORY_WITH_SEPARATOR)},InsideDefinitionFinderVisitor.prototype.visitRepetitionWithSeparator=function(t){this.checkIsTarget(t,c.REPETITION_WITH_SEPARATOR)},InsideDefinitionFinderVisitor.prototype.visitAlternation=function(t){this.checkIsTarget(t,c.ALTERNATION)},InsideDefinitionFinderVisitor}(i.gast.GAstVisitor);e.getLookaheadPathsForOr=getLookaheadPathsForOr,e.getLookaheadPathsForOptionalProd=getLookaheadPathsForOptionalProd,e.containsPath=containsPath},function(t,e,n){"use strict";function possiblePathsFrom(t,e,n){function remainingPathWith(e){return e.concat(a.drop(t,o+1))}function getAlternativesForProd(t){var o=possiblePathsFrom(remainingPathWith(t.definition),e,n);return r.concat(o)}void 0===n&&(n=[]),n=a.cloneArr(n);for(var r=[],o=0;n.length<e&&o<t.length;){var s=t[o];if(s instanceof i.gast.Flat)return getAlternativesForProd(s);if(s instanceof i.gast.NonTerminal)return getAlternativesForProd(s);if(s instanceof i.gast.Option)r=getAlternativesForProd(s);else{if(s instanceof i.gast.RepetitionMandatory)return getAlternativesForProd(s);if(s instanceof i.gast.RepetitionMandatoryWithSeparator)return getAlternativesForProd(s);if(s instanceof i.gast.RepetitionWithSeparator)r=getAlternativesForProd(s);else if(s instanceof i.gast.Repetition)r=getAlternativesForProd(s);else{if(s instanceof i.gast.Alternation)return a.forEach(s.definition,function(t){r=getAlternativesForProd(t)}),r;if(!(s instanceof i.gast.Terminal))throw Error("non exhaustive match");n.push(s.terminalType)}}o++}return r.push(n),r}var r=this&&this.__extends||function(t,e){function __(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)},o=n(16),i=n(7),a=n(4),s=n(10),c=n(13),u=function(t){function AbstractNextPossibleTokensWalker(e,n){t.call(this),this.topProd=e,this.path=n,this.possibleTokTypes=[],this.nextProductionName="",this.nextProductionOccurrence=0,this.found=!1,this.isAtEndOfPath=!1}return r(AbstractNextPossibleTokensWalker,t),AbstractNextPossibleTokensWalker.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=a.cloneArr(this.path.ruleStack).reverse(),this.occurrenceStack=a.cloneArr(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},AbstractNextPossibleTokensWalker.prototype.walk=function(e,n){void 0===n&&(n=[]),this.found||t.prototype.walk.call(this,e,n)},AbstractNextPossibleTokensWalker.prototype.walkProdRef=function(t,e,n){if(t.referencedRule.name===this.nextProductionName&&t.occurrenceInParent===this.nextProductionOccurrence){var r=e.concat(n);this.updateExpectedNext(),this.walk(t.referencedRule,r)}},AbstractNextPossibleTokensWalker.prototype.updateExpectedNext=function(){a.isEmpty(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},AbstractNextPossibleTokensWalker}(o.RestWalker);e.AbstractNextPossibleTokensWalker=u;var l=function(t){function NextAfterTokenWalker(e,n){t.call(this,e,n),this.path=n,this.nextTerminalName="",this.nextTerminalOccurrence=0,this.nextTerminalName=s.tokenName(this.path.lastTok),this.nextTerminalOccurrence=this.path.lastTokOccurrence}return r(NextAfterTokenWalker,t),NextAfterTokenWalker.prototype.walkTerminal=function(t,e,n){if(this.isAtEndOfPath&&s.tokenName(t.terminalType)===this.nextTerminalName&&t.occurrenceInParent===this.nextTerminalOccurrence&&!this.found){var r=e.concat(n),o=new i.gast.Flat(r);this.possibleTokTypes=c.first(o),this.found=!0}},NextAfterTokenWalker}(u);e.NextAfterTokenWalker=l;var p=function(t){function AbstractNextTerminalAfterProductionWalker(e,n){t.call(this),this.topRule=e,this.occurrence=n,this.result={token:void 0,occurrence:void 0,isEndOfRule:void 0}}return r(AbstractNextTerminalAfterProductionWalker,t),AbstractNextTerminalAfterProductionWalker.prototype.startWalking=function(){return this.walk(this.topRule),this.result},AbstractNextTerminalAfterProductionWalker}(o.RestWalker);e.AbstractNextTerminalAfterProductionWalker=p;var f=function(t){function NextTerminalAfterManyWalker(){t.apply(this,arguments)}return r(NextTerminalAfterManyWalker,t),NextTerminalAfterManyWalker.prototype.walkMany=function(e,n,r){if(e.occurrenceInParent===this.occurrence){var o=a.first(n.concat(r));this.result.isEndOfRule=void 0===o,o instanceof i.gast.Terminal&&(this.result.token=o.terminalType,this.result.occurrence=o.occurrenceInParent)}else t.prototype.walkMany.call(this,e,n,r)},NextTerminalAfterManyWalker}(p);e.NextTerminalAfterManyWalker=f;var h=function(t){function NextTerminalAfterManySepWalker(){t.apply(this,arguments)}return r(NextTerminalAfterManySepWalker,t),NextTerminalAfterManySepWalker.prototype.walkManySep=function(e,n,r){if(e.occurrenceInParent===this.occurrence){var o=a.first(n.concat(r));this.result.isEndOfRule=void 0===o,o instanceof i.gast.Terminal&&(this.result.token=o.terminalType,this.result.occurrence=o.occurrenceInParent)}else t.prototype.walkManySep.call(this,e,n,r)},NextTerminalAfterManySepWalker}(p);e.NextTerminalAfterManySepWalker=h;var d=function(t){function NextTerminalAfterAtLeastOneWalker(){t.apply(this,arguments)}return r(NextTerminalAfterAtLeastOneWalker,t),NextTerminalAfterAtLeastOneWalker.prototype.walkAtLeastOne=function(e,n,r){if(e.occurrenceInParent===this.occurrence){var o=a.first(n.concat(r));this.result.isEndOfRule=void 0===o,o instanceof i.gast.Terminal&&(this.result.token=o.terminalType,this.result.occurrence=o.occurrenceInParent)}else t.prototype.walkAtLeastOne.call(this,e,n,r)},NextTerminalAfterAtLeastOneWalker}(p);e.NextTerminalAfterAtLeastOneWalker=d;var E=function(t){function NextTerminalAfterAtLeastOneSepWalker(){t.apply(this,arguments)}return r(NextTerminalAfterAtLeastOneSepWalker,t),NextTerminalAfterAtLeastOneSepWalker.prototype.walkAtLeastOneSep=function(e,n,r){if(e.occurrenceInParent===this.occurrence){var o=a.first(n.concat(r));this.result.isEndOfRule=void 0===o,o instanceof i.gast.Terminal&&(this.result.token=o.terminalType,this.result.occurrence=o.occurrenceInParent)}else t.prototype.walkAtLeastOneSep.call(this,e,n,r)},NextTerminalAfterAtLeastOneSepWalker}(p);e.NextTerminalAfterAtLeastOneSepWalker=E,e.possiblePathsFrom=possiblePathsFrom},function(t,e,n){"use strict";function restForRepetitionWithSeparator(t,e,n){var o=[new r.gast.Option([new r.gast.Terminal(t.separator)].concat(t.definition))],i=o.concat(e,n);return i}var r=n(7),o=n(4),i=function(){function RestWalker(){}return RestWalker.prototype.walk=function(t,e){var n=this;void 0===e&&(e=[]),o.forEach(t.definition,function(i,a){var s=o.drop(t.definition,a+1);if(i instanceof r.gast.NonTerminal)n.walkProdRef(i,s,e);else if(i instanceof r.gast.Terminal)n.walkTerminal(i,s,e);else if(i instanceof r.gast.Flat)n.walkFlat(i,s,e);else if(i instanceof r.gast.Option)n.walkOption(i,s,e);else if(i instanceof r.gast.RepetitionMandatory)n.walkAtLeastOne(i,s,e);else if(i instanceof r.gast.RepetitionMandatoryWithSeparator)n.walkAtLeastOneSep(i,s,e);else if(i instanceof r.gast.RepetitionWithSeparator)n.walkManySep(i,s,e);else if(i instanceof r.gast.Repetition)n.walkMany(i,s,e);else{if(!(i instanceof r.gast.Alternation))throw Error("non exhaustive match");n.walkOr(i,s,e)}})},RestWalker.prototype.walkTerminal=function(t,e,n){},RestWalker.prototype.walkProdRef=function(t,e,n){},RestWalker.prototype.walkFlat=function(t,e,n){var r=e.concat(n);this.walk(t,r)},RestWalker.prototype.walkOption=function(t,e,n){var r=e.concat(n);this.walk(t,r)},RestWalker.prototype.walkAtLeastOne=function(t,e,n){var o=[new r.gast.Option(t.definition)].concat(e,n);this.walk(t,o)},RestWalker.prototype.walkAtLeastOneSep=function(t,e,n){var r=restForRepetitionWithSeparator(t,e,n);this.walk(t,r)},RestWalker.prototype.walkMany=function(t,e,n){var o=[new r.gast.Option(t.definition)].concat(e,n);this.walk(t,o)},RestWalker.prototype.walkManySep=function(t,e,n){var r=restForRepetitionWithSeparator(t,e,n);this.walk(t,r)},RestWalker.prototype.walkOr=function(t,e,n){var i=this,a=e.concat(n);o.forEach(t.definition,function(t){var e=new r.gast.Flat([t]);i.walk(e,a)})},RestWalker}();e.RestWalker=i},function(t,e,n){"use strict";function computeAllProdsFollows(t){var e=new i.HashTable;return c.forEach(t,function(t){var n=new p(t).startWalking();e.putAll(n)}),e}function buildBetweenProdsFollowPrefix(t,e){return t.name+e+u.IN}function buildInProdFollowPrefix(t){var e=l.tokenName(t.terminalType);return e+t.occurrenceInParent+u.IN}var r=this&&this.__extends||function(t,e){function __(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)},o=n(16),i=n(3),a=n(7),s=n(13),c=n(4),u=n(18),l=n(10),p=function(t){function ResyncFollowsWalker(e){t.call(this),this.topProd=e,this.follows=new i.HashTable}return r(ResyncFollowsWalker,t),ResyncFollowsWalker.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},ResyncFollowsWalker.prototype.walkTerminal=function(t,e,n){},ResyncFollowsWalker.prototype.walkProdRef=function(t,e,n){var r=buildBetweenProdsFollowPrefix(t.referencedRule,t.occurrenceInParent)+this.topProd.name,o=e.concat(n),i=new a.gast.Flat(o),c=s.first(i);this.follows.put(r,c)},ResyncFollowsWalker}(o.RestWalker);e.ResyncFollowsWalker=p,e.computeAllProdsFollows=computeAllProdsFollows,e.buildBetweenProdsFollowPrefix=buildBetweenProdsFollowPrefix,e.buildInProdFollowPrefix=buildInProdFollowPrefix},function(t,e){"use strict";e.IN="_~IN~_"},function(t,e,n){"use strict";function buildTopProduction(t,n,o){e.terminalNameToConstructor=o;var i=" "+t,a=removeComments(" "+i),s=removeStringLiterals(a),c=createRanges(s),u=new r.Range(0,t.length+2);return buildTopLevel(n,u,c,t)}function buildTopLevel(t,e,n,r){var i=new o.gast.Rule(t,[],r);return buildAbstractProd(i,e,n)}function buildProdGast(t,e){switch(t.type){case a.AT_LEAST_ONE:return buildAtLeastOneProd(t,e);case a.AT_LEAST_ONE_SEP:return buildAtLeastOneSepProd(t,e);case a.MANY_SEP:return buildManySepProd(t,e);case a.MANY:return buildManyProd(t,e);case a.OPTION:return buildOptionProd(t,e);case a.OR:return buildOrProd(t,e);case a.FLAT:return buildAbstractProd(new o.gast.Flat([]),t.range,e);case a.REF:return buildRefProd(t);case a.TERMINAL:return buildTerminalProd(t);default:throw Error("non exhaustive match")}}function buildRefProd(t){var e=u.exec(t.text),n=void 0===e[1],r=n?1:parseInt(e[1],10),i=e[2],a=new o.gast.NonTerminal(i,void 0,r);return a.implicitOccurrenceIndex=n,a}function buildTerminalProd(t){var n=s.exec(t.text),r=void 0===n[1],i=r?1:parseInt(n[1],10),a=n[2],c=e.terminalNameToConstructor[a];if(!c)throw Error("Terminal Token name: "+a+" not found");var u=new o.gast.Terminal(c,i);return u.implicitOccurrenceIndex=r,u}function buildProdWithOccurrence(t,e,n,r){var o=t.exec(n.text),i=void 0===o[1];return e.occurrenceInParent=i?1:parseInt(o[1],10),e.implicitOccurrenceIndex=i,buildAbstractProd(e,n.range,r)}function buildAtLeastOneProd(t,e){return buildProdWithOccurrence(y,new o.gast.RepetitionMandatory([]),t,e)}function buildAtLeastOneSepProd(t,e){return buildRepetitionWithSep(t,e,o.gast.RepetitionMandatoryWithSeparator,A)}function buildManyProd(t,e){return buildProdWithOccurrence(h,new o.gast.Repetition([]),t,e)}function buildManySepProd(t,e){return buildRepetitionWithSep(t,e,o.gast.RepetitionWithSeparator,E)}function buildRepetitionWithSep(t,n,r,o){var i=o.exec(t.text),a=void 0===i[1],s=a?1:parseInt(i[1],10),c=i[2],u=e.terminalNameToConstructor[c];if(!u)throw Error("Separator Terminal Token name: "+c+" not found");var l=new r([],u,s);return l.implicitOccurrenceIndex=a,buildAbstractProd(l,t.range,n)}function buildOptionProd(t,e){return buildProdWithOccurrence(p,new o.gast.Option([]),t,e)}function buildOrProd(t,e){return buildProdWithOccurrence(R,new o.gast.Alternation([]),t,e)}function buildAbstractProd(t,e,n){var r=getDirectlyContainedRanges(e,n),o=i.sortBy(r,function(t){return t.range.start}),a=[];return i.forEach(o,function(t){a.push(buildProdGast(t,n))}),t.definition=a,t}function getDirectlyContainedRanges(t,e){return i.filter(e,function(n){var r=t.strictlyContainsRange(n.range),o=i.every(e,function(e){var r=e.range.strictlyContainsRange(n.range),o=e.range.isStrictlyContainedInRange(t);return!(r&&o)});return r&&o})}function removeComments(t){var e=t.replace(m,""),n=e.replace(P,"");return n}function removeStringLiterals(t){var e=t.replace(N,""),n=e.replace(L,"");return n}function createRanges(t){var e=createTerminalRanges(t),n=createRefsRanges(t),r=createAtLeastOneRanges(t),o=createAtLeastOneSepRanges(t),i=createManyRanges(t),a=createManySepRanges(t),s=createOptionRanges(t),c=createOrRanges(t);return[].concat(e,n,r,o,i,a,s,c)}function createTerminalRanges(t){return createRefOrTerminalProdRangeInternal(t,a.TERMINAL,c)}function createRefsRanges(t){return createRefOrTerminalProdRangeInternal(t,a.REF,l)}function createAtLeastOneRanges(t){return createOperatorProdRangeParenthesis(t,a.AT_LEAST_ONE,O)}function createAtLeastOneSepRanges(t){return createOperatorProdRangeParenthesis(t,a.AT_LEAST_ONE_SEP,_)}function createManyRanges(t){return createOperatorProdRangeParenthesis(t,a.MANY,d)}function createManySepRanges(t){return createOperatorProdRangeParenthesis(t,a.MANY_SEP,T)}function createOptionRanges(t){return createOperatorProdRangeParenthesis(t,a.OPTION,f)}function createOrRanges(t){var e=createOperatorProdRangeParenthesis(t,a.OR,v),n=createOrPartRanges(e);return e.concat(n)}function createOrPartRanges(t){var e=[];i.forEach(t,function(t){var n=createOperatorProdRangeInternal(t.text,a.FLAT,g,S),r=t.range.start;i.forEach(n,function(t){t.range.start+=r,t.range.end+=r}),e=e.concat(n)});var n=i.uniq(e,function(t){return t.type+"~"+t.range.start+"~"+t.range.end+"~"+t.text});return n}function createRefOrTerminalProdRangeInternal(t,e,n){for(var o,i=[];o=n.exec(t);){var a=o.index,s=n.lastIndex,c=new r.Range(a,s),u=o[0];i.push({range:c,text:u,type:e})}return i}function createOperatorProdRangeParenthesis(t,e,n){return createOperatorProdRangeInternal(t,e,n,k)}function createOperatorProdRangeInternal(t,e,n,o){for(var i,a=[];i=n.exec(t);){var s=i.index,c=o(s+i[0].length,t),u=new r.Range(s,c),l=t.substr(s,c-s+1);a.push({range:u,text:l,type:e})}return a}function findClosingOffset(t,e,n,r){for(var o=[1],a=-1;!i.isEmpty(o)&&a+n<r.length;){a++;var s=r.charAt(n+a);s===t?o.push(1):s===e&&o.pop()}if(i.isEmpty(o))return a+n;throw new Error("INVALID INPUT TEXT, UNTERMINATED PARENTHESIS")}var r=n(20),o=n(7),i=n(4);!function(t){t[t.OPTION=0]="OPTION",t[t.OR=1]="OR",t[t.MANY=2]="MANY",t[t.MANY_SEP=3]="MANY_SEP",t[t.AT_LEAST_ONE=4]="AT_LEAST_ONE",t[t.AT_LEAST_ONE_SEP=5]="AT_LEAST_ONE_SEP",t[t.REF=6]="REF",t[t.TERMINAL=7]="TERMINAL",t[t.FLAT=8]="FLAT"}(e.ProdType||(e.ProdType={}));var a=e.ProdType,s=/\.\s*CONSUME(\d)?\s*\(\s*(?:[a-zA-Z_$]\w*\s*\.\s*)*([a-zA-Z_$]\w*)/,c=new RegExp(s.source,"g"),u=/\.\s*SUBRULE(\d)?\s*\(\s*(?:[a-zA-Z_$]\w*\s*\.\s*)*([a-zA-Z_$]\w*)/,l=new RegExp(u.source,"g"),p=/\.\s*OPTION(\d)?\s*\(/,f=new RegExp(p.source,"g"),h=/\.\s*MANY(\d)?\s*\(/,d=new RegExp(h.source,"g"),E=/\.\s*MANY_SEP(\d)?\s*\(\s*(?:[a-zA-Z_$]\w*\s*\.\s*)*([a-zA-Z_$]\w*)/,T=new RegExp(E.source,"g"),A=/\.\s*AT_LEAST_ONE_SEP(\d)?\s*\(\s*(?:[a-zA-Z_$]\w*\s*\.\s*)*([a-zA-Z_$]\w*)/,_=new RegExp(A.source,"g"),y=/\.\s*AT_LEAST_ONE(\d)?\s*\(/,O=new RegExp(y.source,"g"),R=/\.\s*OR(\d)?\s*\(/,v=new RegExp(R.source,"g"),g=/{\s*(WHEN|ALT)\s*:/g;e.terminalNameToConstructor={},e.buildTopProduction=buildTopProduction,e.buildProdGast=buildProdGast,e.getDirectlyContainedRanges=getDirectlyContainedRanges;var m=/\/\/.*/g,P=/\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\//g,N=/"([^\\"]+|\\([bfnrtv"\\/]|u[0-9a-fA-F]{4}))*"/g,L=/'([^\\']+|\\([bfnrtv'\\/]|u[0-9a-fA-F]{4}))*'/g;e.removeComments=removeComments,e.removeStringLiterals=removeStringLiterals,e.createRanges=createRanges,e.createTerminalRanges=createTerminalRanges,e.createRefsRanges=createRefsRanges,e.createAtLeastOneRanges=createAtLeastOneRanges,e.createAtLeastOneSepRanges=createAtLeastOneSepRanges,e.createManyRanges=createManyRanges,e.createManySepRanges=createManySepRanges,e.createOptionRanges=createOptionRanges,e.createOrRanges=createOrRanges;var S=i.partial(findClosingOffset,"{","}"),k=i.partial(findClosingOffset,"(",")");e.createOrPartRanges=createOrPartRanges,e.findClosingOffset=findClosingOffset},function(t,e){"use strict";function isValidRange(t,e){return!(0>t||t>e)}var n=function(){function Range(t,e){if(this.start=t,this.end=e,!isValidRange(t,e))throw new Error("INVALID RANGE")}return Range.prototype.contains=function(t){return this.start<=t&&this.end>=t},Range.prototype.containsRange=function(t){return this.start<=t.start&&this.end>=t.end},Range.prototype.isContainedInRange=function(t){return t.containsRange(this)},Range.prototype.strictlyContainsRange=function(t){return this.start<t.start&&this.end>t.end},Range.prototype.isStrictlyContainedInRange=function(t){return t.strictlyContainsRange(this)},Range}();e.Range=n,e.isValidRange=isValidRange},function(t,e,n){"use strict";function clearCache(){r.clearCache()}var r=n(2);e.clearCache=clearCache}])});