<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Tutorial - Semantics Embedded Actions | Chevrotain</title>
    <meta name="description" content="Parser Building Toolkit for JavaScript">
    
    
    <link rel="preload" href="/chevrotain/docs/assets/css/0.styles.a96c3778.css" as="style"><link rel="preload" href="/chevrotain/docs/assets/js/app.c2aae2fa.js" as="script"><link rel="preload" href="/chevrotain/docs/assets/js/42.af7b164e.js" as="script"><link rel="prefetch" href="/chevrotain/docs/assets/js/10.cf625237.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/11.40d0be53.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/12.b97367c1.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/13.6d708524.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/14.9bb065e3.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/15.79cbc5f8.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/16.f5153e30.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/17.9a02eb0f.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/18.b00b3535.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/19.dce9f478.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/2.e6b85e1a.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/20.d336854a.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/21.1bb1be00.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/22.96a50323.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/23.5b3cbbe8.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/24.b9b54479.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/25.7731f527.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/26.fc8a935a.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/27.4073e213.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/28.e1789044.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/29.803b8128.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/3.e0874ba7.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/30.bee1413a.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/31.3b453add.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/32.9fa8ff77.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/33.34359d05.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/34.bb3725ae.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/35.1e8dd349.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/36.f6ad0cf9.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/37.1fdeea17.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/38.f6d10767.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/39.fdafde87.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/4.e442ae01.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/40.25846a28.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/41.37cde4f6.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/43.662f95e5.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/44.5e1d7cf4.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/5.e663830f.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/6.a8d7a373.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/7.59a48604.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/8.b6a09a52.js"><link rel="prefetch" href="/chevrotain/docs/assets/js/9.85d09fa1.js">
    <link rel="stylesheet" href="/chevrotain/docs/assets/css/0.styles.a96c3778.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/chevrotain/docs/" class="home-link router-link-active"><!----> <span class="site-name">Chevrotain</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/chevrotain/docs/" class="nav-link">Home</a></div><div class="nav-item"><a href="/chevrotain/docs/features/blazing_fast.html" class="nav-link">Features</a></div><div class="nav-item"><a href="/chevrotain/docs/tutorial/step0_introduction.html" class="nav-link">Tutorial</a></div><div class="nav-item"><a href="/chevrotain/docs/guide/introduction.html" class="nav-link">Guide</a></div><div class="nav-item"><a href="/chevrotain/docs/FAQ.html" class="nav-link">FAQ</a></div><div class="nav-item"><a href="/chevrotain/docs/changes/BREAKING_CHANGES.html" class="nav-link">Changes</a></div><div class="nav-item"><a href="https://sap.github.io/chevrotain/documentation/4_3_1/globals.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  APIs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://sap.github.io/chevrotain/playground/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Playground
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://sap.github.io/chevrotain/performance/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Benchmark
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://gitter.im/chevrotain-parser/Lobby" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Chat
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/SAP/chevrotain" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/chevrotain/docs/" class="nav-link">Home</a></div><div class="nav-item"><a href="/chevrotain/docs/features/blazing_fast.html" class="nav-link">Features</a></div><div class="nav-item"><a href="/chevrotain/docs/tutorial/step0_introduction.html" class="nav-link">Tutorial</a></div><div class="nav-item"><a href="/chevrotain/docs/guide/introduction.html" class="nav-link">Guide</a></div><div class="nav-item"><a href="/chevrotain/docs/FAQ.html" class="nav-link">FAQ</a></div><div class="nav-item"><a href="/chevrotain/docs/changes/BREAKING_CHANGES.html" class="nav-link">Changes</a></div><div class="nav-item"><a href="https://sap.github.io/chevrotain/documentation/4_3_1/globals.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  APIs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://sap.github.io/chevrotain/playground/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Playground
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://sap.github.io/chevrotain/performance/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Benchmark
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://gitter.im/chevrotain-parser/Lobby" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Chat
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/SAP/chevrotain" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Tutorial</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/chevrotain/docs/tutorial/step0_introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/chevrotain/docs/tutorial/step1_lexing.html" class="sidebar-link">Lexer</a></li><li><a href="/chevrotain/docs/tutorial/step2_parsing.html" class="sidebar-link">Parser</a></li><li><a href="/chevrotain/docs/tutorial/step3_adding_actions_root.html" class="sidebar-link">Semantics</a></li><li><a href="/chevrotain/docs/tutorial/step3a_adding_actions_visitor.html" class="sidebar-link">Semantics - CST Visitor</a></li><li><a href="/chevrotain/docs/tutorial/step3b_adding_actions_embedded.html" class="active sidebar-link">Semantics - Embedded</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/chevrotain/docs/tutorial/step3b_adding_actions_embedded.html#simple-example" class="sidebar-link">Simple Example</a></li><li class="sidebar-sub-header"><a href="/chevrotain/docs/tutorial/step3b_adding_actions_embedded.html#sql-grammar" class="sidebar-link">SQL Grammar</a></li></ul></li><li><a href="/chevrotain/docs/tutorial/step4_fault_tolerance.html" class="sidebar-link">Fault Tolerance</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="tutorial-semantics-embedded-actions"><a href="#tutorial-semantics-embedded-actions" aria-hidden="true" class="header-anchor">#</a> Tutorial - Semantics Embedded Actions</h1> <h3 id="tldr"><a href="#tldr" aria-hidden="true" class="header-anchor">#</a> TLDR</h3> <p><a href="https://github.com/SAP/chevrotain/tree/master/examples/tutorial/step3_actions/step3b_actions_embedded.js" target="_blank" rel="noopener noreferrer">Run and Debug the source code<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h3 id="introduction"><a href="#introduction" aria-hidden="true" class="header-anchor">#</a> Introduction</h3> <p>In the <a href="/chevrotain/docs/tutorial/step2_parsing.html">previous</a> tutorial step
we have implemented a parser for a &quot;mini&quot; SQL Select grammar. The current problem is that our parser only
validates the input conforms to the grammar. In most real world use cases the parser will also have to output some
result/data structure/value.</p> <p>This can be accomplished using two features of the Parsing DSL:</p> <ul><li><a href="https://sap.github.io/chevrotain/documentation/4_3_1/classes/parser.html#consume1" target="_blank" rel="noopener noreferrer">CONSUME<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> will return
The <a href="https://sap.github.io/chevrotain/documentation/4_3_1/interfaces/itoken.html" target="_blank" rel="noopener noreferrer">IToken<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> object consumed.</li> <li><a href="https://sap.github.io/chevrotain/documentation/4_3_1/classes/parser.html#subrule1" target="_blank" rel="noopener noreferrer">SUBRULE<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> will return
the result of the grammar rule invoked.</li></ul> <h3 id="enabling-embedded-actions"><a href="#enabling-embedded-actions" aria-hidden="true" class="header-anchor">#</a> Enabling embedded actions</h3> <p>For embedded actions to work as expected the automatic CST creation must first be disabled.
The CST creation is controlled by the <strong>outputCst</strong> flag of the parser <a href="https://sap.github.io/chevrotain/documentation/4_3_1/interfaces/iparserconfig.html" target="_blank" rel="noopener noreferrer">configuration object<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">SelectParserEmbedded</span> <span class="token keyword">extends</span> <span class="token class-name">Parser</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>
            tokenVocabulary<span class="token punctuation">,</span>
            <span class="token comment">// we have to explicitly disable the CST building for embedded actions to work.</span>
            <span class="token punctuation">{</span> outputCst<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Failing to disabled the CST creation would cause the Parser to return a CST of the grammar rule
we invoked instead of of the expected output structure we will be creating (an AST).</p> <h2 id="simple-example"><a href="#simple-example" aria-hidden="true" class="header-anchor">#</a> Simple Example</h2> <p>Lets inspect a simple contrived example:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>$<span class="token punctuation">.</span><span class="token constant">RULE</span><span class="token punctuation">(</span><span class="token string">&quot;topRule&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token number">0</span>

    $<span class="token punctuation">.</span><span class="token constant">MANY</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        $<span class="token punctuation">.</span><span class="token constant">OR</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token constant">ALT</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    result <span class="token operator">+=</span> $<span class="token punctuation">.</span><span class="token constant">SUBRULE</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span>decimalRule<span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token constant">ALT</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    result <span class="token operator">+=</span> $<span class="token punctuation">.</span><span class="token constant">SUBRULE</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span>IntegerRule<span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> result
<span class="token punctuation">}</span><span class="token punctuation">)</span>

$<span class="token punctuation">.</span><span class="token constant">RULE</span><span class="token punctuation">(</span><span class="token string">&quot;decimalRule&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> decimalToken <span class="token operator">=</span> $<span class="token punctuation">.</span><span class="token constant">CONSUME</span><span class="token punctuation">(</span>Decimal<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token function">parseFloat</span><span class="token punctuation">(</span>decimalToken<span class="token punctuation">.</span>image<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

$<span class="token punctuation">.</span><span class="token constant">RULE</span><span class="token punctuation">(</span><span class="token string">&quot;IntegerRule&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> intToken <span class="token operator">=</span> $<span class="token punctuation">.</span><span class="token constant">CONSUME</span><span class="token punctuation">(</span>Integer<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>intToken<span class="token punctuation">.</span>image<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>The <strong>decimalRule</strong> and <strong>IntegerRule</strong> both return a javascript number (using parseInt/parseFloat).
and the <strong>topRule</strong> adds it to the final result.</p> <h2 id="sql-grammar"><a href="#sql-grammar" aria-hidden="true" class="header-anchor">#</a> SQL Grammar</h2> <p>Lets go back to the mini SQL Select grammar.</p> <p>For this grammar we will build a more complex data structure (an AST) instead of simply returning a number.
Our selectStatement rule will now return an object with four properties:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>$<span class="token punctuation">.</span><span class="token constant">RULE</span><span class="token punctuation">(</span><span class="token string">&quot;selectStatement&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> select<span class="token punctuation">,</span> <span class="token keyword">from</span><span class="token punctuation">,</span> where

    select <span class="token operator">=</span> $<span class="token punctuation">.</span><span class="token constant">SUBRULE</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span>selectClause<span class="token punctuation">)</span>
    <span class="token keyword">from</span> <span class="token operator">=</span> $<span class="token punctuation">.</span><span class="token constant">SUBRULE</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span>fromClause<span class="token punctuation">)</span>
    $<span class="token punctuation">.</span><span class="token constant">OPTION</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        where <span class="token operator">=</span> $<span class="token punctuation">.</span><span class="token constant">SUBRULE</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span>whereClause<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        type<span class="token punctuation">:</span> <span class="token string">&quot;SELECT_STMT&quot;</span><span class="token punctuation">,</span>
        selectClause<span class="token punctuation">:</span> select<span class="token punctuation">,</span>
        fromClause<span class="token punctuation">:</span> <span class="token keyword">from</span><span class="token punctuation">,</span>
        <span class="token comment">// may be undefined if the OPTION was not entered.</span>
        whereClause<span class="token punctuation">:</span> where
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Three of those properties (selectClause / fromClause / whereClause) are the results of invoking
other parser rules.</p> <p>Lets look at the &quot;selectClause&quot; rule implemntaiton:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>$<span class="token punctuation">.</span><span class="token constant">RULE</span><span class="token punctuation">(</span><span class="token string">&quot;selectClause&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

    $<span class="token punctuation">.</span><span class="token constant">CONSUME</span><span class="token punctuation">(</span>Select<span class="token punctuation">)</span>
    $<span class="token punctuation">.</span><span class="token constant">AT_LEAST_ONE_SEP</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token constant">SEP</span><span class="token punctuation">:</span> Comma<span class="token punctuation">,</span>
        <span class="token constant">DEF</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// accessing a token's string via getImage utility</span>
            columns<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span><span class="token constant">CONSUME</span><span class="token punctuation">(</span>Identifier<span class="token punctuation">)</span><span class="token punctuation">.</span>image<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        type<span class="token punctuation">:</span> <span class="token string">&quot;SELECT_CLAUSE&quot;</span><span class="token punctuation">,</span>
        columns<span class="token punctuation">:</span> columns
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>In the selectClause rule we access the <strong>image</strong> property of the Identifier token returned from <strong>CONSUME</strong>
and push each of these strings to the <strong>columns</strong> array.</p></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/SAP/chevrotain/edit/master/docs/tutorial/step3b_adding_actions_embedded.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/chevrotain/docs/tutorial/step3a_adding_actions_visitor.html" class="prev">
          Semantics - CST Visitor
        </a></span> <span class="next"><a href="/chevrotain/docs/tutorial/step4_fault_tolerance.html">
          Fault Tolerance
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/chevrotain/docs/assets/js/app.c2aae2fa.js" defer></script><script src="/chevrotain/docs/assets/js/42.af7b164e.js" defer></script>
  </body>
</html>
